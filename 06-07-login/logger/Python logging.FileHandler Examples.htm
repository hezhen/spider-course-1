
<!-- saved from url=(0066)http://www.programcreek.com/python/example/472/logging.FileHandler -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        

 
					<title>Python logging.FileHandler Examples</title>
			<meta name="description" content="This page provides python code examples for logging.FileHandler.
					The examples are extracted from open source python projects from GitHub. ">
			<meta name="keywords" content="Python code examples for logging.FileHandler">
		


		<link type="text/css" rel="stylesheet" media="screen" href="./Python logging.FileHandler Examples_files/style.css">
		<link type="text/css" rel="stylesheet" media="screen" href="./Python logging.FileHandler Examples_files/code.css">
		<link type="text/css" rel="stylesheet" media="screen" href="./Python logging.FileHandler Examples_files/prettify.css">

		<script async="" src="./Python logging.FileHandler Examples_files/analytics.js"></script><script language="javaScript" src="./Python logging.FileHandler Examples_files/prettify.js"></script>
		<script language="javascript" src="./Python logging.FileHandler Examples_files/jquery.js"></script>
		<script language="javaScript" src="./Python logging.FileHandler Examples_files/jquery.highlight-3.js"></script>




		
	<script type="text/javascript" async="" src="http://programcreek.disqus.com/embed.js"></script><style type="text/css" id="notify-bootstrap">.notifyjs-bootstrap-base {
	font-weight: bold;
	padding: 8px 15px 8px 14px;
	text-shadow: 0 1px 0 rgba(255, 255, 255, 0.5);
	background-color: #fcf8e3;
	border: 1px solid #fbeed5;
	-webkit-border-radius: 4px;
	-moz-border-radius: 4px;
	border-radius: 4px;
	white-space: nowrap;
	padding-left: 25px;
	background-repeat: no-repeat;
	background-position: 3px 7px;
}
.notifyjs-bootstrap-error {
	color: #B94A48;
	background-color: #F2DEDE;
	border-color: #EED3D7;
	background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAtRJREFUeNqkVc1u00AQHq+dOD+0poIQfkIjalW0SEGqRMuRnHos3DjwAH0ArlyQeANOOSMeAA5VjyBxKBQhgSpVUKKQNGloFdw4cWw2jtfMOna6JOUArDTazXi/b3dm55socPqQhFka++aHBsI8GsopRJERNFlY88FCEk9Yiwf8RhgRyaHFQpPHCDmZG5oX2ui2yilkcTT1AcDsbYC1NMAyOi7zTX2Agx7A9luAl88BauiiQ/cJaZQfIpAlngDcvZZMrl8vFPK5+XktrWlx3/ehZ5r9+t6e+WVnp1pxnNIjgBe4/6dAysQc8dsmHwPcW9C0h3fW1hans1ltwJhy0GxK7XZbUlMp5Ww2eyan6+ft/f2FAqXGK4CvQk5HueFz7D6GOZtIrK+srupdx1GRBBqNBtzc2AiMr7nPplRdKhb1q6q6zjFhrklEFOUutoQ50xcX86ZlqaZpQrfbBdu2R6/G19zX6XSgh6RX5ubyHCM8nqSID6ICrGiZjGYYxojEsiw4PDwMSL5VKsC8Yf4VRYFzMzMaxwjlJSlCyAQ9l0CW44PBADzXhe7xMdi9HtTrdYjFYkDQL0cn4Xdq2/EAE+InCnvADTf2eah4Sx9vExQjkqXT6aAERICMewd/UAp/IeYANM2joxt+q5VI+ieq2i0Wg3l6DNzHwTERPgo1ko7XBXj3vdlsT2F+UuhIhYkp7u7CarkcrFOCtR3H5JiwbAIeImjT/YQKKBtGjRFCU5IUgFRe7fF4cCNVIPMYo3VKqxwjyNAXNepuopyqnld602qVsfRpEkkz+GFL1wPj6ySXBpJtWVa5xlhpcyhBNwpZHmtX8AGgfIExo0ZpzkWVTBGiXCSEaHh62/PoR0p/vHaczxXGnj4bSo+G78lELU80h1uogBwWLf5YlsPmgDEd4M236xjm+8nm4IuE/9u+/PH2JXZfbwz4zw1WbO+SQPpXfwG/BBgAhCNZiSb/pOQAAAAASUVORK5CYII=);
}
.notifyjs-bootstrap-success {
	color: #468847;
	background-color: #DFF0D8;
	border-color: #D6E9C6;
	background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAutJREFUeNq0lctPE0Ecx38zu/RFS1EryqtgJFA08YCiMZIAQQ4eRG8eDGdPJiYeTIwHTfwPiAcvXIwXLwoXPaDxkWgQ6islKlJLSQWLUraPLTv7Gme32zoF9KSTfLO7v53vZ3d/M7/fIth+IO6INt2jjoA7bjHCJoAlzCRw59YwHYjBnfMPqAKWQYKjGkfCJqAF0xwZjipQtA3MxeSG87VhOOYegVrUCy7UZM9S6TLIdAamySTclZdYhFhRHloGYg7mgZv1Zzztvgud7V1tbQ2twYA34LJmF4p5dXF1KTufnE+SxeJtuCZNsLDCQU0+RyKTF27Unw101l8e6hns3u0PBalORVVVkcaEKBJDgV3+cGM4tKKmI+ohlIGnygKX00rSBfszz/n2uXv81wd6+rt1orsZCHRdr1Imk2F2Kob3hutSxW8thsd8AXNaln9D7CTfA6O+0UgkMuwVvEFFUbbAcrkcTA8+AtOk8E6KiQiDmMFSDqZItAzEVQviRkdDdaFgPp8HSZKAEAL5Qh7Sq2lIJBJwv2scUqkUnKoZgNhcDKhKg5aH+1IkcouCAdFGAQsuWZYhOjwFHQ96oagWgRoUov1T9kRBEODAwxM2QtEUl+Wp+Ln9VRo6BcMw4ErHRYjH4/B26AlQoQQTRdHWwcd9AH57+UAXddvDD37DmrBBV34WfqiXPl61g+vr6xA9zsGeM9gOdsNXkgpEtTwVvwOklXLKm6+/p5ezwk4B+j6droBs2CsGa/gNs6RIxazl4Tc25mpTgw/apPR1LYlNRFAzgsOxkyXYLIM1V8NMwyAkJSctD1eGVKiq5wWjSPdjmeTkiKvVW4f2YPHWl3GAVq6ymcyCTgovM3FzyRiDe2TaKcEKsLpJvNHjZgPNqEtyi6mZIm4SRFyLMUsONSSdkPeFtY1n0mczoY3BHTLhwPRy9/lzcziCw9ACI+yql0VLzcGAZbYSM5CCSZg1/9oc/nn7+i8N9p/8An4JMADxhH+xHfuiKwAAAABJRU5ErkJggg==);
}
.notifyjs-bootstrap-info {
	color: #3A87AD;
	background-color: #D9EDF7;
	border-color: #BCE8F1;
	background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QYFAhkSsdes/QAAA8dJREFUOMvVlGtMW2UYx//POaWHXg6lLaW0ypAtw1UCgbniNOLcVOLmAjHZolOYlxmTGXVZdAnRfXQm+7SoU4mXaOaiZsEpC9FkiQs6Z6bdCnNYruM6KNBw6YWewzl9z+sHImEWv+vz7XmT95f/+3/+7wP814v+efDOV3/SoX3lHAA+6ODeUFfMfjOWMADgdk+eEKz0pF7aQdMAcOKLLjrcVMVX3xdWN29/GhYP7SvnP0cWfS8caSkfHZsPE9Fgnt02JNutQ0QYHB2dDz9/pKX8QjjuO9xUxd/66HdxTeCHZ3rojQObGQBcuNjfplkD3b19Y/6MrimSaKgSMmpGU5WevmE/swa6Oy73tQHA0Rdr2Mmv/6A1n9w9suQ7097Z9lM4FlTgTDrzZTu4StXVfpiI48rVcUDM5cmEksrFnHxfpTtU/3BFQzCQF/2bYVoNbH7zmItbSoMj40JSzmMyX5qDvriA7QdrIIpA+3cdsMpu0nXI8cV0MtKXCPZev+gCEM1S2NHPvWfP/hL+7FSr3+0p5RBEyhEN5JCKYr8XnASMT0xBNyzQGQeI8fjsGD39RMPk7se2bd5ZtTyoFYXftF6y37gx7NeUtJJOTFlAHDZLDuILU3j3+H5oOrD3yWbIztugaAzgnBKJuBLpGfQrS8wO4FZgV+c1IxaLgWVU0tMLEETCos4xMzEIv9cJXQcyagIwigDGwJgOAtHAwAhisQUjy0ORGERiELgG4iakkzo4MYAxcM5hAMi1WWG1yYCJIcMUaBkVRLdGeSU2995TLWzcUAzONJ7J6FBVBYIggMzmFbvdBV44Corg8vjhzC+EJEl8U1kJtgYrhCzgc/vvTwXKSib1paRFVRVORDAJAsw5FuTaJEhWM2SHB3mOAlhkNxwuLzeJsGwqWzf5TFNdKgtY5qHp6ZFf67Y/sAVadCaVY5YACDDb3Oi4NIjLnWMw2QthCBIsVhsUTU9tvXsjeq9+X1d75/KEs4LNOfcdf/+HthMnvwxOD0wmHaXr7ZItn2wuH2SnBzbZAbPJwpPx+VQuzcm7dgRCB57a1uBzUDRL4bfnI0RE0eaXd9W89mpjqHZnUI5Hh2l2dkZZUhOqpi2qSmpOmZ64Tuu9qlz/SEXo6MEHa3wOip46F1n7633eekV8ds8Wxjn37Wl63VVa+ej5oeEZ/82ZBETJjpJ1Rbij2D3Z/1trXUvLsblCK0XfOx0SX2kMsn9dX+d+7Kf6h8o4AIykuffjT8L20LU+w4AZd5VvEPY+XpWqLV327HR7DzXuDnD8r+ovkBehJ8i+y8YAAAAASUVORK5CYII=);
}
.notifyjs-bootstrap-warn {
	color: #C09853;
	background-color: #FCF8E3;
	border-color: #FBEED5;
	background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAABJlBMVEXr6eb/2oD/wi7/xjr/0mP/ykf/tQD/vBj/3o7/uQ//vyL/twebhgD/4pzX1K3z8e349vK6tHCilCWbiQymn0jGworr6dXQza3HxcKkn1vWvV/5uRfk4dXZ1bD18+/52YebiAmyr5S9mhCzrWq5t6ufjRH54aLs0oS+qD751XqPhAybhwXsujG3sm+Zk0PTwG6Shg+PhhObhwOPgQL4zV2nlyrf27uLfgCPhRHu7OmLgAafkyiWkD3l49ibiAfTs0C+lgCniwD4sgDJxqOilzDWowWFfAH08uebig6qpFHBvH/aw26FfQTQzsvy8OyEfz20r3jAvaKbhgG9q0nc2LbZxXanoUu/u5WSggCtp1anpJKdmFz/zlX/1nGJiYmuq5Dx7+sAAADoPUZSAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfdBgUBGhh4aah5AAAAlklEQVQY02NgoBIIE8EUcwn1FkIXM1Tj5dDUQhPU502Mi7XXQxGz5uVIjGOJUUUW81HnYEyMi2HVcUOICQZzMMYmxrEyMylJwgUt5BljWRLjmJm4pI1hYp5SQLGYxDgmLnZOVxuooClIDKgXKMbN5ggV1ACLJcaBxNgcoiGCBiZwdWxOETBDrTyEFey0jYJ4eHjMGWgEAIpRFRCUt08qAAAAAElFTkSuQmCC);
}
</style><style type="text/css" id="core-notify">.notifyjs-corner {
	position: fixed;
	margin: 5px;
	z-index: 1050;
}

.notifyjs-corner .notifyjs-wrapper,
.notifyjs-corner .notifyjs-container {
	position: relative;
	display: block;
	height: inherit;
	width: inherit;
	margin: 3px;
}

.notifyjs-wrapper {
	z-index: 1;
	position: absolute;
	display: inline-block;
	height: 0;
	width: 0;
}

.notifyjs-container {
	display: none;
	z-index: 1;
	position: absolute;
}

.notifyjs-hidable {
	cursor: pointer;
}

[data-notify-text],[data-notify-html] {
	position: relative;
}

.notifyjs-arrow {
	position: absolute;
	z-index: 2;
	width: 0;
	height: 0;
}</style></head>

	<body onload="prettyPrint()">
		<script>
			  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
			
			  ga('create', 'UA-7639629-4', 'auto');
			  ga('send', 'pageview');
			
			</script>

<div id="header">



	<div id="header-center">
		
	<span id="login" style="font-size: 15px; ">
	<a href="http://www.programcreek.com/python/">Search</a>
			 &nbsp;&nbsp;&nbsp;&nbsp;
	<a href="http://www.programcreek.com/python/index/module/list">Top APIs</a>
			&nbsp;&nbsp;&nbsp;&nbsp;
	<a href="http://www.programcreek.com/2012/04/java-vs-python-why-python-can-be-more-productive/">Python vs. Java</a>	 				 			
				&nbsp;&nbsp;&nbsp;&nbsp;
	<a href="http://www.programcreek.com/">Program Creek</a>
				 
			
	</span>
			
			<span style="float:right; margin-top: 4px;">
			
			
				
				<ins class="adsbygoogle" style="display:inline-block;width:728px;height:15px" data-ad-client="ca-pub-5732630628268628" data-ad-slot="4667918815"></ins>
				<script>
				(adsbygoogle = window.adsbygoogle || []).push({});
				</script>
			
				
			</span>


			
	</div>



</div>
    
 <div style="clear:both"></div>
	  
 

 <!-- main content-->


<script language="javaScript">
$(document).ready(function(){

	$('.vote_up').click(function(){
		var item_id = $(this).attr("id");
		
		
		$(this).text("thanks");
		$(this).fadeOut(2000);
		//alert(item_id);
		$.post('http://www.programcreek.com/python/back.php',
		{
			todo: "vote_up",
			example_id: item_id 
		},function(data){
			//$(this).text(data);
			$('#memo_list').text(data);
		});	
	});


	$('.vote_down').click(function(){
		var item_id = $(this).attr("id");
		
		
		$(this).text("thanks");
		$(this).fadeOut(2000);
		//alert(item_id);
		$.post('http://www.programcreek.com/python/back.php',
		{
			todo: "vote_down",
			example_id: item_id 
		},function(data){
			//$(this).text(data);
			$('#memo_list').text(data);
		});	
	});
});
</script>

 

<div id="content">


<div style="width:300px; float:right; margin-left:10px; margin-top:24px;">

	<div style="height: 50px;clear:both; "></div>

	<script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	
	<!-- 
		<a href="http://www.aspose.com/total-component-suite.aspx?utm_source=ProgramCreek&utm_medium=banner&utm_campaign=ProgramCreek-1">
		<img src="http://www.programcreek.com/aspose.gif" alt="" style="width:300px;height:250px;">
		</a>
		<div style="height: 10px;clear:both;"></div>
	 -->
	
	
	
	<!-- python-side-bar-1-square -->
	<ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-5732630628268628" data-ad-slot="9184333618"></ins>
	<script>
	(adsbygoogle = window.adsbygoogle || []).push({});
	</script>
	
	<div style="height: 10px;clear:both;"></div>
	
	
	<ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-5732630628268628" data-ad-slot="6091266410"></ins>
	<script>
	(adsbygoogle = window.adsbygoogle || []).push({});
	</script>
	
	<div style="height: 10px;clear:both;"></div>
	
	
	<ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-5732630628268628" data-ad-slot="6091266410"></ins>
	<script>
	(adsbygoogle = window.adsbygoogle || []).push({});
	</script>
	
	<div style="height: 10px;clear:both;"></div>
	
	
	
	<!-- python-side-bar-bottom-large -->
	<ins class="adsbygoogle" style="display:inline-block;width:300px;height:600px" data-ad-client="ca-pub-5732630628268628" data-ad-slot="4474932419"></ins>
	<script>
	(adsbygoogle = window.adsbygoogle || []).push({});
	</script>

	<div style="height: 10px;clear:both;"></div>
	<!-- 
	<div style="width:300px; text-align: center;">
		<ins class="adsbygoogle"
		     style="display:inline-block;width:160px;height:600px"
		     data-ad-client="ca-pub-5732630628268628"
		     data-ad-slot="5442436014"></ins>
		<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
		</script>
	</div>
	-->

</div>





<div id="content2">

<div style="text-align: center;">
<h1>
	Python <i>logging.FileHandler</i> Examples
</h1>
</div>


<br>

<p style="line-height: 150%;">The following are <span style="color: #0586E3;"><i>45</i></span> 
code examples for showing how to use
<span style="color:#0586E3;"><i>logging.FileHandler</i></span>. They are 
extracted from open source Python projects.
You can click 
<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="20"> to
	 vote up the examples you like, or click 
<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="20">
	to vote down the exmaples you don't like.
	
	
	Your votes will be used in our system to extract more high-quality examples.
</p>

<p style="line-height: 150%; margin-top:20px;">
	You may also check out all available functions/classes of the module 
	<span style="color: #0586E3;">
	<a href="http://www.programcreek.com/python/index/5/logging">
	logging	</a>	
	</span>, or try 
	<a href="http://www.programcreek.com/python/">the search function
	<img src="./Python logging.FileHandler Examples_files/search.png" width="15">
	</a>.
	
</p>
	
	<br>
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 1</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">gummer-master</span>, 
				under directory <span style="font-style:italic;"></span>, 
				in source file <span style="font-style:italic;">gummer.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 16				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="14194">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="14194">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> set_up_log</span><span class="pun">():</span><span class="pln">

	logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="str">'gummerlog'</span><span class="pun">)</span><span class="pln">
	logger</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">
	</span><span class="com"># create file handler which logs even debug messages</span><span class="pln">
	filelog </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'log/gummer.log'</span><span class="pun">)</span><span class="pln">
	filelog</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">
	</span><span class="com"># create console handler with a higher log level</span><span class="pln">
	consolelog </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">()</span><span class="pln">
	consolelog</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">ERROR</span><span class="pun">)</span><span class="pln"> </span><span class="com">#Change to ERROR before the release</span><span class="pln">
	</span><span class="com"># create formatter and add it to the handlers</span><span class="pln">
	formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'%(asctime)s - %(name)s - %(levelname)s: %(message)s'</span><span class="pun">)</span><span class="pln">
	filelog</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
	consolelog</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
	</span><span class="com"># add the handlers to logger</span><span class="pln">
	logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">consolelog</span><span class="pun">)</span><span class="pln">
	logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">filelog</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> logger

 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 2</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">galaxy-beta1-master</span>, 
				under directory <span style="font-style:italic;">lib/galaxy</span>, 
				in source file <span style="font-style:italic;">config.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 14				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="111388">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="111388">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> configure_logging</span><span class="pun">(</span><span class="pln"> config </span><span class="pun">):</span><span class="pln">
    </span><span class="str">"""
    Allow some basic logging configuration to be read from ini file.
    """</span><span class="pln">
    </span><span class="com"># Get root logger</span><span class="pln">
    root </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">()</span><span class="pln">
    </span><span class="com"># PasteScript will have already configured the logger if the</span><span class="pln">
    </span><span class="com"># 'loggers' section was found in the config file, otherwise we do</span><span class="pln">
    </span><span class="com"># some simple setup using the 'log_*' values from the config.</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> config</span><span class="pun">.</span><span class="pln">global_conf_parser</span><span class="pun">.</span><span class="pln">has_section</span><span class="pun">(</span><span class="pln"> </span><span class="str">"loggers"</span><span class="pln"> </span><span class="pun">):</span><span class="pln">
        format </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln"> </span><span class="str">"log_format"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"%(name)s %(levelname)s %(asctime)s %(message)s"</span><span class="pln"> </span><span class="pun">)</span><span class="pln">
        level </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">_levelNames</span><span class="pun">[</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln"> </span><span class="str">"log_level"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"DEBUG"</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">]</span><span class="pln">
        destination </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln"> </span><span class="str">"log_destination"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"stdout"</span><span class="pln"> </span><span class="pun">)</span><span class="pln">
        log</span><span class="pun">.</span><span class="pln">info</span><span class="pun">(</span><span class="pln"> </span><span class="str">"Logging at '%s' level to '%s'"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> level</span><span class="pun">,</span><span class="pln"> destination </span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span><span class="pln">
        </span><span class="com"># Set level</span><span class="pln">
        root</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln"> level </span><span class="pun">)</span><span class="pln">
        </span><span class="com"># Turn down paste httpserver logging</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> level </span><span class="pun">&lt;=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">:</span><span class="pln">
            logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="pln"> </span><span class="str">"paste.httpserver.ThreadPool"</span><span class="pln"> </span><span class="pun">).</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">WARN </span><span class="pun">)</span><span class="pln">
        </span><span class="com"># Remove old handlers</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> h </span><span class="kwd">in</span><span class="pln"> root</span><span class="pun">.</span><span class="pln">handlers</span><span class="pun">[:]:</span><span class="pln">
            root</span><span class="pun">.</span><span class="pln">removeHandler</span><span class="pun">(</span><span class="pln">h</span><span class="pun">)</span><span class="pln">
        </span><span class="com"># Create handler</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> destination </span><span class="pun">==</span><span class="pln"> </span><span class="str">"stdout"</span><span class="pun">:</span><span class="pln">
            handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">(</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">stdout </span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="pln"> destination </span><span class="pun">)</span><span class="pln">
        </span><span class="com"># Create formatter</span><span class="pln">
        formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="pln"> format </span><span class="pun">)</span><span class="pln">
        </span><span class="com"># Hook everything up</span><span class="pln">
        handler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln"> formatter </span><span class="pun">)</span><span class="pln">
        root</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln"> handler </span><span class="pun">)</span><span class="pln">
    </span><span class="com"># If sentry is configured, also log to it</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> config</span><span class="pun">.</span><span class="pln">sentry_dsn</span><span class="pun">:</span><span class="pln">
        eggs</span><span class="pun">.</span><span class="kwd">require</span><span class="pun">(</span><span class="pln"> </span><span class="str">"raven"</span><span class="pln"> </span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">from</span><span class="pln"> raven</span><span class="pun">.</span><span class="pln">handlers</span><span class="pun">.</span><span class="pln">logging </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">SentryHandler</span><span class="pln">
        sentry_handler </span><span class="pun">=</span><span class="pln"> </span><span class="typ">SentryHandler</span><span class="pun">(</span><span class="pln"> config</span><span class="pun">.</span><span class="pln">sentry_dsn </span><span class="pun">)</span><span class="pln">
        sentry_handler</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">WARN </span><span class="pun">)</span><span class="pln">
        root</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln"> sentry_handler </span><span class="pun">)</span><span class="pln">


 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 3</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">Gamez</span>, 
				under directory <span style="font-style:italic;">cherrypy</span>, 
				in source file <span style="font-style:italic;">_cplogging.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="11829">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="11829">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> reopen_files</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">):</span><span class="pln">
        </span><span class="str">"""Close and reopen all file handlers."""</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> log </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">error_log</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">access_log</span><span class="pun">):</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> h </span><span class="kwd">in</span><span class="pln"> log</span><span class="pun">.</span><span class="pln">handlers</span><span class="pun">:</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> isinstance</span><span class="pun">(</span><span class="pln">h</span><span class="pun">,</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">):</span><span class="pln">
                    h</span><span class="pun">.</span><span class="pln">acquire</span><span class="pun">()</span><span class="pln">
                    h</span><span class="pun">.</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">close</span><span class="pun">()</span><span class="pln">
                    h</span><span class="pun">.</span><span class="pln">stream </span><span class="pun">=</span><span class="pln"> open</span><span class="pun">(</span><span class="pln">h</span><span class="pun">.</span><span class="pln">baseFilename</span><span class="pun">,</span><span class="pln"> h</span><span class="pun">.</span><span class="pln">mode</span><span class="pun">)</span><span class="pln">
                    h</span><span class="pun">.</span><span class="pln">release</span><span class="pun">()</span><span class="pln">
    
     </span></pre><br>
		</div>
		
	</div>
	
			<!-- python-after-3rd-example -->
		<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5732630628268628" data-ad-slot="9800192811" data-ad-format="auto"></ins>
		<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
		</script>
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 4</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">Sick-Beard</span>, 
				under directory <span style="font-style:italic;">cherrypy</span>, 
				in source file <span style="font-style:italic;">_cplogging.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="13761">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="13761">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> reopen_files</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">):</span><span class="pln">
        </span><span class="str">"""Close and reopen all file handlers."""</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> log </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">error_log</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">access_log</span><span class="pun">):</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> h </span><span class="kwd">in</span><span class="pln"> log</span><span class="pun">.</span><span class="pln">handlers</span><span class="pun">:</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> isinstance</span><span class="pun">(</span><span class="pln">h</span><span class="pun">,</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">):</span><span class="pln">
                    h</span><span class="pun">.</span><span class="pln">acquire</span><span class="pun">()</span><span class="pln">
                    h</span><span class="pun">.</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">close</span><span class="pun">()</span><span class="pln">
                    h</span><span class="pun">.</span><span class="pln">stream </span><span class="pun">=</span><span class="pln"> open</span><span class="pun">(</span><span class="pln">h</span><span class="pun">.</span><span class="pln">baseFilename</span><span class="pun">,</span><span class="pln"> h</span><span class="pun">.</span><span class="pln">mode</span><span class="pun">)</span><span class="pln">
                    h</span><span class="pun">.</span><span class="pln">release</span><span class="pun">()</span><span class="pln">
    
     </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 5</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">ClusterNap</span>, 
				under directory <span style="font-style:italic;">bin</span>, 
				in source file <span style="font-style:italic;">logset.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="17812">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="17812">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> </span><span class="kwd">get</span><span class="pun">(</span><span class="pln">loggername</span><span class="pun">,</span><span class="pln"> logfile</span><span class="pun">):</span><span class="pln">
    log </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="pln">loggername</span><span class="pun">)</span><span class="pln">
</span><span class="com">#    logdir       = os.path.dirname(os.path.abspath(__file__)) + "/../logs/"</span><span class="pln">
</span><span class="com">#    date         = datetime.datetime.now().strftime('%Y-%m-%d')</span><span class="pln">
    formatter    </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'%(asctime)s  [%(levelname)s] %(module)s.py: %(message)s'</span><span class="pun">,</span><span class="pln"> datefmt</span><span class="pun">=</span><span class="str">'%I:%M:%S %p'</span><span class="pun">)</span><span class="pln">
    handler_file </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="pln"> logdir </span><span class="pun">+</span><span class="pln"> date </span><span class="pun">+</span><span class="pln"> </span><span class="str">'_'</span><span class="pun">+</span><span class="pln"> logfile</span><span class="pun">)</span><span class="pln">
    handler_file</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> log</span><span class="pun">.</span><span class="pln">handlers</span><span class="pun">:</span><span class="com"># &lt;---!?</span><span class="pln">
	log</span><span class="pun">.</span><span class="pln">handlers </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">

    log</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">handler_file</span><span class="pun">)</span><span class="pln">
    log</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> log
 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 6</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">cloudman-master</span>, 
				under directory <span style="font-style:italic;">cm/boot</span>, 
				in source file <span style="font-style:italic;">__init__.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="19638">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="19638">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> _setup_global_logger</span><span class="pun">():</span><span class="pln">
    formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="pln">
        </span><span class="str">"%(asctime)s %(levelname)-5s %(module)8s:%(lineno)-3d - %(message)s"</span><span class="pun">)</span><span class="pln">
    console </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">()</span><span class="pln">  </span><span class="com"># log to console - used during testing</span><span class="pln">
    </span><span class="com"># console.setLevel(logging.INFO) # accepts &gt;INFO levels</span><span class="pln">
    console</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
    log_file </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="pln">
        os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">LOG_PATH</span><span class="pun">,</span><span class="pln"> </span><span class="str">"%s.log"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">basename</span><span class="pun">(</span><span class="pln">__file__</span><span class="pun">)[:-</span><span class="lit">3</span><span class="pun">]),</span><span class="pln"> </span><span class="str">'w'</span><span class="pun">)</span><span class="pln">  </span><span class="com"># log to a file</span><span class="pln">
    log_file</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">  </span><span class="com"># accepts all levels</span><span class="pln">
    log_file</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
    new_logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">root
    new_logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">console</span><span class="pun">)</span><span class="pln">
    new_logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">log_file</span><span class="pun">)</span><span class="pln">
    new_logger</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> new_logger


 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 7</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">mtoolkit</span>, 
				under directory <span style="font-style:italic;">mtoolkit</span>, 
				in source file <span style="font-style:italic;">console.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="19906">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="19906">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> build_logger</span><span class="pun">():</span><span class="pln">
    </span><span class="str">"""
    Build a custom logger which provides
    log data to the cmdline and in a log_file
    """</span><span class="pln">

    logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="str">'mt_logger'</span><span class="pun">)</span><span class="pln">
    logger</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">

    console_handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">()</span><span class="pln">
    logfile_handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'log_file.log'</span><span class="pun">)</span><span class="pln">

    console_handler</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">)</span><span class="pln">
    logfile_handler</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">

    formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="pln">
        </span><span class="str">'%(levelname)s - %(message)s - %(asctime)s'</span><span class="pun">)</span><span class="pln">

    console_handler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
    logfile_handler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">

    logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">console_handler</span><span class="pun">)</span><span class="pln">
    logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">logfile_handler</span><span class="pun">)</span><span class="pln">
 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 8</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">django-test-utils</span>, 
				under directory <span style="font-style:italic;">test_project/test_app/tests</span>, 
				in source file <span style="font-style:italic;">crawler_tests.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="23770">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="23770">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> setUp</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">log </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="str">'crawler'</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">[</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">log</span><span class="pun">.</span><span class="pln">removeHandler</span><span class="pun">(</span><span class="pln">h</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> h </span><span class="kwd">in</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">log</span><span class="pun">.</span><span class="pln">handlers</span><span class="pun">]</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">log</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">
        handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'crawler_log'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'a'</span><span class="pun">)</span><span class="pln">
        handler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'%(message)s'</span><span class="pun">))</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">log</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">handler</span><span class="pun">)</span><span class="pln">

     </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 9</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">taurus-master</span>, 
				under directory <span style="font-style:italic;">bzt/modules</span>, 
				in source file <span style="font-style:italic;">blazemeter.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="24066">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="24066">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> __get_jtls_and_more</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">):</span><span class="pln">
        </span><span class="str">"""
        Compress all files in artifacts dir to single zipfile
        :return: BytesIO
        """</span><span class="pln">
        mfile </span><span class="pun">=</span><span class="pln"> </span><span class="typ">BytesIO</span><span class="pun">()</span><span class="pln">
        </span><span class="kwd">with</span><span class="pln"> zipfile</span><span class="pun">.</span><span class="typ">ZipFile</span><span class="pun">(</span><span class="pln">mfile</span><span class="pun">,</span><span class="pln"> mode</span><span class="pun">=</span><span class="str">'w'</span><span class="pun">,</span><span class="pln"> compression</span><span class="pun">=</span><span class="pln">zipfile</span><span class="pun">.</span><span class="pln">ZIP_DEFLATED</span><span class="pun">,</span><span class="pln"> allowZip64</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> zfh</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> handler </span><span class="kwd">in</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">engine</span><span class="pun">.</span><span class="pln">log</span><span class="pun">.</span><span class="pln">parent</span><span class="pun">.</span><span class="pln">handlers</span><span class="pun">:</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> isinstance</span><span class="pun">(</span><span class="pln">handler</span><span class="pun">,</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">):</span><span class="pln">
                    zfh</span><span class="pun">.</span><span class="pln">write</span><span class="pun">(</span><span class="pln">handler</span><span class="pun">.</span><span class="pln">baseFilename</span><span class="pun">,</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">basename</span><span class="pun">(</span><span class="pln">handler</span><span class="pun">.</span><span class="pln">baseFilename</span><span class="pun">))</span><span class="pln">

            </span><span class="kwd">for</span><span class="pln"> root</span><span class="pun">,</span><span class="pln"> _dirs</span><span class="pun">,</span><span class="pln"> files </span><span class="kwd">in</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">walk</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">engine</span><span class="pun">.</span><span class="pln">artifacts_dir</span><span class="pun">):</span><span class="pln">
                </span><span class="kwd">for</span><span class="pln"> filename </span><span class="kwd">in</span><span class="pln"> files</span><span class="pun">:</span><span class="pln">
                    zfh</span><span class="pun">.</span><span class="pln">write</span><span class="pun">(</span><span class="pln">os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">root</span><span class="pun">,</span><span class="pln"> filename</span><span class="pun">),</span><span class="pln"> filename</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> mfile

     </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 10</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">taurus-master</span>, 
				under directory <span style="font-style:italic;">bzt</span>, 
				in source file <span style="font-style:italic;">cli.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="24090">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="24090">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> __close_log</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">):</span><span class="pln">
        </span><span class="str">"""
        Close log handlers, move log to artifacts dir
        :return:
        """</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">log</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> platform</span><span class="pun">.</span><span class="pln">system</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'Windows'</span><span class="pun">:</span><span class="pln">
                </span><span class="com"># need to finalize the logger before moving file</span><span class="pln">
                </span><span class="kwd">for</span><span class="pln"> handler </span><span class="kwd">in</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">log</span><span class="pun">.</span><span class="pln">handlers</span><span class="pun">:</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pln"> issubclass</span><span class="pun">(</span><span class="pln">handler</span><span class="pun">.</span><span class="pln">__class__</span><span class="pun">,</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">):</span><span class="pln">
                        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">log</span><span class="pun">.</span><span class="pln">debug</span><span class="pun">(</span><span class="str">"Closing log handler: %s"</span><span class="pun">,</span><span class="pln"> handler</span><span class="pun">.</span><span class="pln">baseFilename</span><span class="pun">)</span><span class="pln">
                        handler</span><span class="pun">.</span><span class="pln">close</span><span class="pun">()</span><span class="pln">
                        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">log</span><span class="pun">.</span><span class="pln">handlers</span><span class="pun">.</span><span class="pln">remove</span><span class="pun">(</span><span class="pln">handler</span><span class="pun">)</span><span class="pln">
                </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">engine</span><span class="pun">.</span><span class="pln">existing_artifact</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">log</span><span class="pun">)</span><span class="pln">
                os</span><span class="pun">.</span><span class="pln">remove</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">log</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
                </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">engine</span><span class="pun">.</span><span class="pln">existing_artifact</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">log</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">True</span><span class="pun">)</span><span class="pln">

     </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 11</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">xen</span>, 
				under directory <span style="font-style:italic;">tools/python/logging/logging-0.4.9.2/test</span>, 
				in source file <span style="font-style:italic;">log_test16.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="31702">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="31702">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> test</span><span class="pun">():</span><span class="pln">
    f </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">"%(asctime)s %(levelname)-9s %(name)-8s %(thread)5s %(message)s"</span><span class="pun">)</span><span class="pln">
    root </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="str">''</span><span class="pun">)</span><span class="pln">
    root</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">
    h </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'thread.log'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'w'</span><span class="pun">)</span><span class="pln">
    root</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">h</span><span class="pun">)</span><span class="pln">
    h</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">f</span><span class="pun">)</span><span class="pln">
    h </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">handlers</span><span class="pun">.</span><span class="typ">SocketHandler</span><span class="pun">(</span><span class="str">'localhost'</span><span class="pun">,</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">handlers</span><span class="pun">.</span><span class="pln">DEFAULT_TCP_LOGGING_PORT</span><span class="pun">)</span><span class="pln">
    </span><span class="com">#h = logging.handlers.DatagramHandler('localhost', logging.handlers.DEFAULT_UDP_LOGGING_PORT)</span><span class="pln">
    root</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">h</span><span class="pun">)</span><span class="pln">
    threads </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">NUM_THREADS</span><span class="pun">):</span><span class="pln">
        threads</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">threading</span><span class="pun">.</span><span class="typ">Thread</span><span class="pun">(</span><span class="pln">target</span><span class="pun">=</span><span class="pln">doLog</span><span class="pun">,</span><span class="pln"> args</span><span class="pun">=(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">threads</span><span class="pun">),)))</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> t </span><span class="kwd">in</span><span class="pln"> threads</span><span class="pun">:</span><span class="pln">
        t</span><span class="pun">.</span><span class="pln">start</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> t </span><span class="kwd">in</span><span class="pln"> threads</span><span class="pun">:</span><span class="pln">
        t</span><span class="pun">.</span><span class="pln">join</span><span class="pun">()</span><span class="pln">

 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 12</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">xen</span>, 
				under directory <span style="font-style:italic;">tools/python/logging/logging-0.4.9.2/test</span>, 
				in source file <span style="font-style:italic;">log_test1.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="31708">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="31708">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> config</span><span class="pun">():</span><span class="pln">
    logging</span><span class="pun">.</span><span class="pln">basicConfig</span><span class="pun">()</span><span class="pln">
    logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="str">""</span><span class="pun">).</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> __name__ </span><span class="pun">==</span><span class="pln"> </span><span class="str">"__main__"</span><span class="pun">:</span><span class="pln">
        fmt </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">"%(asctime)s %(filename)s:%(lineno)d %(levelname)-5s - %(message)s"</span><span class="pun">)</span><span class="pln">
        hdlr </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">"tmp.tmp"</span><span class="pun">)</span><span class="pln">
        hdlr</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">fmt</span><span class="pun">)</span><span class="pln">
        logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="str">""</span><span class="pun">).</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">hdlr</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        fmt </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">None</span><span class="pln">
    hdlr </span><span class="pun">=</span><span class="pln"> </span><span class="typ">SLHandler</span><span class="pun">(</span><span class="str">"log_test1"</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> fmt</span><span class="pun">:</span><span class="pln">
        hdlr</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">fmt</span><span class="pun">)</span><span class="pln">
    logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="str">""</span><span class="pun">).</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">hdlr</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> hdlr

 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 13</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">portfolio</span>, 
				under directory <span style="font-style:italic;">flask/lib/python2.7/site-packages/gunicorn</span>, 
				in source file <span style="font-style:italic;">glogging.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="41122">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="41122">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> reopen_files</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">cfg</span><span class="pun">.</span><span class="pln">errorlog </span><span class="pun">!=</span><span class="pln"> </span><span class="str">"-"</span><span class="pun">:</span><span class="pln">
            </span><span class="com"># if an error log file is set redirect stdout &amp; stderr to</span><span class="pln">
            </span><span class="com"># this log file.</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> stream </span><span class="kwd">in</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">stdout</span><span class="pun">,</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">stderr</span><span class="pun">:</span><span class="pln">
                stream</span><span class="pun">.</span><span class="pln">flush</span><span class="pun">()</span><span class="pln">

            </span><span class="kwd">with</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="kwd">lock</span><span class="pun">:</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">logfile </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">:</span><span class="pln">
                    </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">logfile</span><span class="pun">.</span><span class="pln">close</span><span class="pun">()</span><span class="pln">

                </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">logfile </span><span class="pun">=</span><span class="pln"> open</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">cfg</span><span class="pun">.</span><span class="pln">errorlog</span><span class="pun">,</span><span class="pln"> </span><span class="str">'a+'</span><span class="pun">)</span><span class="pln">
                os</span><span class="pun">.</span><span class="pln">dup2</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">logfile</span><span class="pun">.</span><span class="pln">fileno</span><span class="pun">(),</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">stdout</span><span class="pun">.</span><span class="pln">fileno</span><span class="pun">())</span><span class="pln">
                os</span><span class="pun">.</span><span class="pln">dup2</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">logfile</span><span class="pun">.</span><span class="pln">fileno</span><span class="pun">(),</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">stderr</span><span class="pun">.</span><span class="pln">fileno</span><span class="pun">())</span><span class="pln">

        </span><span class="kwd">for</span><span class="pln"> log </span><span class="kwd">in</span><span class="pln"> loggers</span><span class="pun">():</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> handler </span><span class="kwd">in</span><span class="pln"> log</span><span class="pun">.</span><span class="pln">handlers</span><span class="pun">:</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> isinstance</span><span class="pun">(</span><span class="pln">handler</span><span class="pun">,</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">):</span><span class="pln">
                    handler</span><span class="pun">.</span><span class="pln">acquire</span><span class="pun">()</span><span class="pln">
                    </span><span class="kwd">try</span><span class="pun">:</span><span class="pln">
                        </span><span class="kwd">if</span><span class="pln"> handler</span><span class="pun">.</span><span class="pln">stream</span><span class="pun">:</span><span class="pln">
                            handler</span><span class="pun">.</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">close</span><span class="pun">()</span><span class="pln">
                            handler</span><span class="pun">.</span><span class="pln">stream </span><span class="pun">=</span><span class="pln"> open</span><span class="pun">(</span><span class="pln">handler</span><span class="pun">.</span><span class="pln">baseFilename</span><span class="pun">,</span><span class="pln">
                                    handler</span><span class="pun">.</span><span class="pln">mode</span><span class="pun">)</span><span class="pln">
                    </span><span class="kwd">finally</span><span class="pun">:</span><span class="pln">
                        handler</span><span class="pun">.</span><span class="pln">release</span><span class="pun">()</span><span class="pln">

     </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 14</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">celery</span>, 
				under directory <span style="font-style:italic;">celery/tests</span>, 
				in source file <span style="font-style:italic;">test_log.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="41876">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="41876">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> test_setup_logger_no_handlers_file</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">):</span><span class="pln">
        l </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">get_logger</span><span class="pun">()</span><span class="pln">
        set_handlers</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[])</span><span class="pln">
        tempfile </span><span class="pun">=</span><span class="pln"> mktemp</span><span class="pun">(</span><span class="pln">suffix</span><span class="pun">=</span><span class="str">"unittest"</span><span class="pun">,</span><span class="pln"> prefix</span><span class="pun">=</span><span class="str">"celery"</span><span class="pun">)</span><span class="pln">
        l </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">setup_logger</span><span class="pun">(</span><span class="pln">logfile</span><span class="pun">=</span><span class="pln">tempfile</span><span class="pun">,</span><span class="pln"> loglevel</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">assertIsInstance</span><span class="pun">(</span><span class="pln">get_handlers</span><span class="pun">(</span><span class="pln">l</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">],</span><span class="pln">
                              logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">)</span><span class="pln">

     </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 15</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">celery</span>, 
				under directory <span style="font-style:italic;">celery/tests/app</span>, 
				in source file <span style="font-style:italic;">test_log.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="41879">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="41879">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> test_setup_logger_no_handlers_file</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln"> </span><span class="pun">*</span><span class="pln">args</span><span class="pun">):</span><span class="pln">
        tempfile </span><span class="pun">=</span><span class="pln"> mktemp</span><span class="pun">(</span><span class="pln">suffix</span><span class="pun">=</span><span class="str">'unittest'</span><span class="pun">,</span><span class="pln"> prefix</span><span class="pun">=</span><span class="str">'celery'</span><span class="pun">)</span><span class="pln">
        _open </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="str">'builtins.open'</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">version_info</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">3</span><span class="pln">
                 </span><span class="kwd">else</span><span class="pln"> </span><span class="str">'__builtin__.open'</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">with</span><span class="pln"> patch</span><span class="pun">(</span><span class="pln">_open</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> osopen</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">with</span><span class="pln"> restore_logging</span><span class="pun">():</span><span class="pln">
                files </span><span class="pun">=</span><span class="pln"> defaultdict</span><span class="pun">(</span><span class="typ">StringIO</span><span class="pun">)</span><span class="pln">

                </span><span class="kwd">def</span><span class="pln"> open_file</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="pun">*</span><span class="pln">args</span><span class="pun">,</span><span class="pln"> </span><span class="pun">**</span><span class="pln">kwargs</span><span class="pun">):</span><span class="pln">
                    f </span><span class="pun">=</span><span class="pln"> files</span><span class="pun">[</span><span class="pln">filename</span><span class="pun">]</span><span class="pln">
                    f</span><span class="pun">.</span><span class="pln">fileno </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Mock</span><span class="pun">()</span><span class="pln">
                    f</span><span class="pun">.</span><span class="pln">fileno</span><span class="pun">.</span><span class="pln">return_value </span><span class="pun">=</span><span class="pln"> </span><span class="lit">99</span><span class="pln">
                    </span><span class="kwd">return</span><span class="pln"> f

                osopen</span><span class="pun">.</span><span class="pln">side_effect </span><span class="pun">=</span><span class="pln"> open_file
                l </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">get_logger</span><span class="pun">()</span><span class="pln">
                l</span><span class="pun">.</span><span class="pln">handlers </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
                l </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">setup_logger</span><span class="pun">(</span><span class="pln">
                    logfile</span><span class="pun">=</span><span class="pln">tempfile</span><span class="pun">,</span><span class="pln"> loglevel</span><span class="pun">=</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln">
                </span><span class="pun">)</span><span class="pln">
                </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">assertIsInstance</span><span class="pun">(</span><span class="pln">
                    get_handlers</span><span class="pun">(</span><span class="pln">l</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">,</span><span class="pln">
                </span><span class="pun">)</span><span class="pln">
                </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">assertIn</span><span class="pun">(</span><span class="pln">tempfile</span><span class="pun">,</span><span class="pln"> files</span><span class="pun">)</span><span class="pln">

     </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 16</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">RJGlass</span>, 
				under directory <span style="font-style:italic;">GlassServer</span>, 
				in source file <span style="font-style:italic;">GlassServer.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="44625">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="44625">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> init_log</span><span class="pun">():</span><span class="pln">
    level </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">INFO
    </span><span class="kwd">if</span><span class="pln"> </span><span class="str">'-debug'</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">argv</span><span class="pun">:</span><span class="pln">
        level </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">DEBUG
    logging</span><span class="pun">.</span><span class="pln">basicConfig</span><span class="pun">(</span><span class="pln">level</span><span class="pun">=</span><span class="pln">level</span><span class="pun">,</span><span class="pln"> format</span><span class="pun">=</span><span class="str">'%(asctime)s.%(msecs)d %(levelname)s:%(message)s'</span><span class="pun">,</span><span class="pln"> datefmt</span><span class="pun">=</span><span class="str">'%H:%M:%S'</span><span class="pun">)</span><span class="pln">
    </span><span class="com">#Set up File log</span><span class="pln">
    logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">()</span><span class="pln">
    handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'GlassServer.log'</span><span class="pun">,</span><span class="pln"> mode</span><span class="pun">=</span><span class="str">'w'</span><span class="pun">)</span><span class="pln">
    handler</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">
    handler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'%(asctime)s.%(msecs)d %(levelname)s:%(message)s'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'%H:%M:%S'</span><span class="pun">))</span><span class="pln">
    logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">handler</span><span class="pun">)</span><span class="pln">

 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 17</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">RJGlass</span>, 
				under directory <span style="font-style:italic;">GlassClient</span>, 
				in source file <span style="font-style:italic;">GlassClient.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="44648">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="44648">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> init_log</span><span class="pun">():</span><span class="pln">
    level </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">INFO
    </span><span class="kwd">if</span><span class="pln"> </span><span class="str">'-debug'</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">argv</span><span class="pun">:</span><span class="pln">
        level </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">DEBUG
    logging</span><span class="pun">.</span><span class="pln">basicConfig</span><span class="pun">(</span><span class="pln">level</span><span class="pun">=</span><span class="pln">level</span><span class="pun">,</span><span class="pln"> format</span><span class="pun">=</span><span class="str">'%(asctime)s.%(msecs)d %(levelname)s:%(message)s'</span><span class="pun">,</span><span class="pln"> datefmt</span><span class="pun">=</span><span class="str">'%H:%M:%S'</span><span class="pun">)</span><span class="pln">
    </span><span class="com">#Set up File log</span><span class="pln">
    logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">()</span><span class="pln">
    handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'GlassClient.log'</span><span class="pun">,</span><span class="pln"> mode</span><span class="pun">=</span><span class="str">'w'</span><span class="pun">)</span><span class="pln">
    </span><span class="com">#handler.setLevel(logging.DEBUG)</span><span class="pln">
    handler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'%(asctime)s.%(msecs)d %(levelname)s:%(message)s'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'%H:%M:%S'</span><span class="pun">))</span><span class="pln">
    logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">handler</span><span class="pun">)</span><span class="pln">


</span><span class="com">#Initalize logging</span><span class="pln">
 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 18</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">coi-services</span>, 
				under directory <span style="font-style:italic;">ion/ext/tools</span>, 
				in source file <span style="font-style:italic;">data_product_monitor.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="51029">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="51029">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> monitor_logger</span><span class="pun">(</span><span class="pln">file_level</span><span class="pun">,</span><span class="pln"> console_level </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">):</span><span class="pln">
    function_name </span><span class="pun">=</span><span class="pln"> inspect</span><span class="pun">.</span><span class="pln">stack</span><span class="pun">()[</span><span class="lit">1</span><span class="pun">][</span><span class="lit">3</span><span class="pun">]</span><span class="pln">
    logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="pln">function_name</span><span class="pun">)</span><span class="pln">
    </span><span class="com"># By default, logs all messages</span><span class="pln">
    logger</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">

    </span><span class="com"># StreamHandler logs to console</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> console_level </span><span class="pun">!=</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">:</span><span class="pln">
        ch </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">()</span><span class="pln">
        ch</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">console_level</span><span class="pun">)</span><span class="pln">
        ch_format </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'%(asctime)s - %(message)s'</span><span class="pun">)</span><span class="pln">
        ch</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">ch_format</span><span class="pun">)</span><span class="pln">
        logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">ch</span><span class="pun">)</span><span class="pln">

    fh </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">"{0}.log"</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">function_name</span><span class="pun">))</span><span class="pln">
    fh</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">file_level</span><span class="pun">)</span><span class="pln">
    fh_format </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'%(asctime)s - %(lineno)d - %(levelname)-8s - %(message)s'</span><span class="pun">)</span><span class="pln">
    fh</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">fh_format</span><span class="pun">)</span><span class="pln">
    logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">fh</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">return</span><span class="pln"> logger

 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 19</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">Sugang-turtle-master</span>, 
				under directory <span style="font-style:italic;">turtle</span>, 
				in source file <span style="font-style:italic;">__init__.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="51722">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="51722">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln"> config</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">config </span><span class="pun">=</span><span class="pln"> config
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">emails </span><span class="pun">=</span><span class="pln"> queue</span><span class="pun">.</span><span class="typ">Queue</span><span class="pun">()</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">adapters </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">

        </span><span class="com"># pushbank logger</span><span class="pln">
        current_thread</span><span class="pun">().</span><span class="pln">name </span><span class="pun">=</span><span class="pln"> </span><span class="str">'MAIN'</span><span class="pln">
        root_logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">()</span><span class="pln">
        root_logger</span><span class="pun">.</span><span class="pln">level </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="pln">log_level
        log_formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">"%(asctime)s [%(levelname)-5.5s] [%(threadName)s]  %(message)s"</span><span class="pun">)</span><span class="pln">
        file_handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'tmp/stdout.log'</span><span class="pun">)</span><span class="pln">
        file_handler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">log_formatter</span><span class="pun">)</span><span class="pln">
        root_logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">file_handler</span><span class="pun">)</span><span class="pln">
        console_handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">()</span><span class="pln">
        console_handler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">log_formatter</span><span class="pun">)</span><span class="pln">
        root_logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">console_handler</span><span class="pun">)</span><span class="pln">

        school </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="pln">SCHOOL
        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> util</span><span class="pun">.</span><span class="pln">verify</span><span class="pun">(</span><span class="pln">school</span><span class="pun">):</span><span class="pln">
            </span><span class="kwd">print</span><span class="pln"> u</span><span class="str">"?? ??? ??? ??? ???."</span><span class="pln">
            sys</span><span class="pun">.</span><span class="kwd">exit</span><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span><span class="pln">

        s </span><span class="pun">=</span><span class="pln"> util</span><span class="pun">.</span><span class="pln">get_semester</span><span class="pun">()[</span><span class="str">'semester'</span><span class="pun">]</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> s </span><span class="pun">==</span><span class="pln"> </span><span class="str">"1R"</span><span class="pun">:</span><span class="pln">      
            </span><span class="kwd">print</span><span class="pln"> u</span><span class="str">"?? ??? 1?? ???."</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">print</span><span class="pln"> u</span><span class="str">"?? ??? 2?? ???."</span><span class="pln">

        </span><span class="com"># log in to sugang server</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">login</span><span class="pun">(</span><span class="pln">school</span><span class="pun">)</span><span class="pln">

        </span><span class="com"># connect smtp server</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">connected </span><span class="pun">=</span><span class="pln"> connect_mail</span><span class="pun">(</span><span class="pln">server</span><span class="pun">=</span><span class="pln">config</span><span class="pun">.</span><span class="pln">EMAIL</span><span class="pun">[</span><span class="str">'SMTP_SERVER'</span><span class="pun">],</span><span class="pln">
                                      port</span><span class="pun">=</span><span class="pln">config</span><span class="pun">.</span><span class="pln">EMAIL</span><span class="pun">[</span><span class="str">'SMTP_PORT'</span><span class="pun">],</span><span class="pln">
                                      user</span><span class="pun">=</span><span class="pln">config</span><span class="pun">.</span><span class="pln">EMAIL</span><span class="pun">[</span><span class="str">'SMTP_USER'</span><span class="pun">],</span><span class="pln">
                                      passwd</span><span class="pun">=</span><span class="pln">config</span><span class="pun">.</span><span class="pln">EMAIL</span><span class="pun">[</span><span class="str">'SMTP_PASSWORD'</span><span class="pun">],</span><span class="pln">
                                      tls</span><span class="pun">=</span><span class="pln">config</span><span class="pun">.</span><span class="pln">EMAIL</span><span class="pun">[</span><span class="str">'SMTP_TLS'</span><span class="pun">])</span><span class="pln">

     </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 20</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">SurfaceImageContentGap-master</span>, 
				under directory <span style="font-style:italic;">surfaceimagecontentgap</span>, 
				in source file <span style="font-style:italic;">imagegap.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="57531">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="57531">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> setuplog</span><span class="pun">():</span><span class="pln">
    </span><span class="str">"""Set up the LOG. """</span><span class="pln">
    consolehandler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">()</span><span class="pln">
    formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="pln">
        </span><span class="str">'%(asctime)s    %(levelname)s    %(message)s'</span><span class="pun">)</span><span class="pln">
    consolehandler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
    consolehandler</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">)</span><span class="pln">
    LOG</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">consolehandler</span><span class="pun">)</span><span class="pln">
    logfilehandler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'sicg.log'</span><span class="pun">)</span><span class="pln">
    logfilehandler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
    logfilehandler</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">
    LOG</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">logfilehandler</span><span class="pun">)</span><span class="pln">
    LOG</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">


 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 21</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">BioPy-master</span>, 
				under directory <span style="font-style:italic;">selforganization/pso</span>, 
				in source file <span style="font-style:italic;">psoRun.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="60331">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="60331">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> setup_logger</span><span class="pun">(</span><span class="pln">log_path</span><span class="pun">,</span><span class="pln"> logger_name</span><span class="pun">,</span><span class="pln"> logfile_name</span><span class="pun">):</span><span class="pln">

    logFormatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'%(asctime)s - %(name)s - %(levelname)s - %(message)s'</span><span class="pun">)</span><span class="pln">
    rootLogger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="pln">logger_name</span><span class="pun">)</span><span class="pln">
    rootLogger</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">)</span><span class="pln">

    fileHandler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">"{0}/{1}.log"</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">log_path</span><span class="pun">,</span><span class="pln"> logfile_name</span><span class="pun">),</span><span class="pln"> mode</span><span class="pun">=</span><span class="str">'w'</span><span class="pun">)</span><span class="pln">
    fileHandler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">logFormatter</span><span class="pun">)</span><span class="pln">
    rootLogger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">fileHandler</span><span class="pun">)</span><span class="pln">

    consoleHandler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">()</span><span class="pln">
    consoleHandler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">logFormatter</span><span class="pun">)</span><span class="pln">
    rootLogger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">consoleHandler</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">return</span><span class="pln"> rootLogger


 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 22</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">BioPy-master</span>, 
				under directory <span style="font-style:italic;">neuralnetworks/backpropagation/src</span>, 
				in source file <span style="font-style:italic;">run_tests.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="60336">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="60336">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> setup_logger</span><span class="pun">(</span><span class="pln">log_path</span><span class="pun">,</span><span class="pln"> logger_name</span><span class="pun">,</span><span class="pln"> logfile_name</span><span class="pun">):</span><span class="pln">

    logFormatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'%(asctime)s - %(name)s - %(levelname)s - %(message)s'</span><span class="pun">)</span><span class="pln">
    rootLogger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="pln">logger_name</span><span class="pun">)</span><span class="pln">
    rootLogger</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">

    fileHandler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">"{0}/{1}.log"</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">log_path</span><span class="pun">,</span><span class="pln"> logfile_name</span><span class="pun">))</span><span class="pln">
    fileHandler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">logFormatter</span><span class="pun">)</span><span class="pln">
    rootLogger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">fileHandler</span><span class="pun">)</span><span class="pln">

    consoleHandler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">()</span><span class="pln">
    consoleHandler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">logFormatter</span><span class="pun">)</span><span class="pln">
    rootLogger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">consoleHandler</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">return</span><span class="pln"> rootLogger


 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 23</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">hue</span>, 
				under directory <span style="font-style:italic;">desktop/core/ext-py/south/south</span>, 
				in source file <span style="font-style:italic;">logger.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="67990">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="67990">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> close_logger</span><span class="pun">():</span><span class="pln">
    </span><span class="str">"Closes the logger handler for the file, so we can remove the file after a test."</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> handler </span><span class="kwd">in</span><span class="pln"> _logger</span><span class="pun">.</span><span class="pln">handlers</span><span class="pun">:</span><span class="pln">
        _logger</span><span class="pun">.</span><span class="pln">removeHandler</span><span class="pun">(</span><span class="pln">handler</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> isinstance</span><span class="pun">(</span><span class="pln">handler</span><span class="pun">,</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">):</span><span class="pln">
            handler</span><span class="pun">.</span><span class="pln">close</span><span class="pun">()</span><span class="pln"> </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 24</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">pyff</span>, 
				under directory <span style="font-style:italic;">src/lib/vision_egg</span>, 
				in source file <span style="font-style:italic;">view.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="69958">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="69958">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> __init_attributes</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">):</span><span class="pln">
        </span><span class="str">""" Setup internal attributes. """</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">_logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="str">'VisionEggView'</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">_logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'log'</span><span class="pun">))</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">_screen_acquired </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">_viewports </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">

     </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 25</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">signpost</span>, 
				under directory <span style="font-style:italic;">psp_python</span>, 
				in source file <span style="font-style:italic;">server_discovery.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="73799">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="73799">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> main</span><span class="pun">():</span><span class="pln">
  logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="str">'psp'</span><span class="pun">)</span><span class="pln">
  hdlr </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'psp.log'</span><span class="pun">)</span><span class="pln">
  strm_out </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">(</span><span class="pln">sys</span><span class="pun">.</span><span class="pln">__stdout__</span><span class="pun">)</span><span class="pln">
  formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'%(asctime)s %(levelname)s %(message)s'</span><span class="pun">)</span><span class="pln">
  hdlr</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
  strm_out</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
  logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">hdlr</span><span class="pun">)</span><span class="pln"> 
  logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">strm_out</span><span class="pun">)</span><span class="pln"> 
  logger</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">)</span><span class="pln"> 
 
  obj </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Server_discovery</span><span class="pun">(</span><span class="pln">logger</span><span class="pun">)</span><span class="pln">
  obj</span><span class="pun">.</span><span class="pln">service_update</span><span class="pun">()</span><span class="pln">
  </span><span class="kwd">import</span><span class="pln"> time
  time</span><span class="pun">.</span><span class="pln">sleep</span><span class="pun">(</span><span class="lit">10</span><span class="pun">)</span><span class="pln">
  obj</span><span class="pun">.</span><span class="pln">service_update</span><span class="pun">()</span><span class="pln">

 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 26</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">signpost</span>, 
				under directory <span style="font-style:italic;">psp_python</span>, 
				in source file <span style="font-style:italic;">mdns.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="73803">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="73803">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> 
  </span><span class="com"># initialiaze logging mechanism</span><span class="pln">
  logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="str">'psp'</span><span class="pun">)</span><span class="pln">
  strm_out </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">(</span><span class="pln">sys</span><span class="pun">.</span><span class="pln">__stdout__</span><span class="pun">)</span><span class="pln">
  hdlr </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'mdns.log'</span><span class="pun">)</span><span class="pln">
  formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'%(asctime)s %(levelname)s %(message)s'</span><span class="pun">)</span><span class="pln">
  hdlr</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
  strm_out</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
  logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">hdlr</span><span class="pun">)</span><span class="pln">
  logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">strm_out</span><span class="pun">)</span><span class="pln">
  logger</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">)</span><span class="pln"> 

  mdns_client </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Mdns_client</span><span class="pun">(</span><span class="str">'laptop'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'haris.sp'</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8080</span><span class="pun">,</span><span class="pln"> logger</span><span class="pun">)</span><span class="pln">
  mdns_client</span><span class="pun">.</span><span class="pln">register_callback</span><span class="pun">(</span><span class="str">"leave"</span><span class="pun">,</span><span class="pln"> leave_cb</span><span class="pun">)</span><span class="pln">
  mdns_client</span><span class="pun">.</span><span class="pln">setup_mdns</span><span class="pun">()</span><span class="pln">
  
  </span><span class="com"># run the loop</span><span class="pln">
  gobject</span><span class="pun">.</span><span class="pln">threads_init</span><span class="pun">()</span><span class="pln">
  gobject</span><span class="pun">.</span><span class="typ">MainLoop</span><span class="pun">().</span><span class="pln">run</span><span class="pun">()</span><span class="pln"> 
 

 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 27</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">signpost</span>, 
				under directory <span style="font-style:italic;">psp_python</span>, 
				in source file <span style="font-style:italic;">psp.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="73807">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="73807">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> main</span><span class="pun">():</span><span class="pln">
    </span><span class="com">#init logger</span><span class="pln">
    logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="str">'psp'</span><span class="pun">)</span><span class="pln">
    hdlr </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'psp.log'</span><span class="pun">)</span><span class="pln">
    strm_out </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">(</span><span class="pln">sys</span><span class="pun">.</span><span class="pln">__stdout__</span><span class="pun">)</span><span class="pln">
    formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'%(asctime)s %(levelname)s %(message)s'</span><span class="pun">)</span><span class="pln">
    hdlr</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
    strm_out</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
    logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">hdlr</span><span class="pun">)</span><span class="pln"> 
    logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">strm_out</span><span class="pun">)</span><span class="pln"> 
    logger</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">)</span><span class="pln"> 

    mdns_client </span><span class="pun">=</span><span class="pln"> mdns</span><span class="pun">.</span><span class="typ">Mdns_client</span><span class="pun">(</span><span class="str">'laptop'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'haris.sp'</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8080</span><span class="pun">,</span><span class="pln"> logger</span><span class="pun">)</span><span class="pln">

    </span><span class="com">#init web server </span><span class="pln">
    site </span><span class="pun">=</span><span class="pln"> server</span><span class="pun">.</span><span class="typ">Site</span><span class="pun">(</span><span class="pln">signpost_server</span><span class="pun">.</span><span class="typ">Singpost_server</span><span class="pun">(</span><span class="pln">logger</span><span class="pun">))</span><span class="pln">

    </span><span class="com"># run method in thread</span><span class="pln">
    reactor</span><span class="pun">.</span><span class="pln">suggestThreadPoolSize</span><span class="pun">(</span><span class="lit">30</span><span class="pun">)</span><span class="pln">
    factory </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Factory</span><span class="pun">()</span><span class="pln">
    reactor</span><span class="pun">.</span><span class="pln">listenSSL</span><span class="pun">(</span><span class="lit">8080</span><span class="pun">,</span><span class="pln"> site</span><span class="pun">,</span><span class="pln"> </span><span class="typ">HTTPSVerifyingContextFactory</span><span class="pun">())</span><span class="pln"> </span><span class="com">#myContextFactory)</span><span class="pln">
    mdns_client</span><span class="pun">.</span><span class="pln">setup_mdns</span><span class="pun">()</span><span class="pln">
    
    </span><span class="com">#service discovery module</span><span class="pln">
    discovery </span><span class="pun">=</span><span class="pln"> server_discovery</span><span class="pun">.</span><span class="typ">Server_discovery</span><span class="pun">(</span><span class="pln">logger</span><span class="pun">)</span><span class="pln">
    discovery</span><span class="pun">.</span><span class="pln">service_update</span><span class="pun">()</span><span class="pln"> </span><span class="com">#initial discovery to fetch entries</span><span class="pln">
    gobject</span><span class="pun">.</span><span class="pln">timeout_add</span><span class="pun">(</span><span class="lit">30000</span><span class="pun">,</span><span class="pln"> discovery</span><span class="pun">.</span><span class="pln">service_update</span><span class="pun">)</span><span class="pln">
    
    </span><span class="com"># run the loop</span><span class="pln">
    gobject</span><span class="pun">.</span><span class="pln">threads_init</span><span class="pun">()</span><span class="pln">
    gobject</span><span class="pun">.</span><span class="typ">MainLoop</span><span class="pun">().</span><span class="pln">run</span><span class="pun">()</span><span class="pln"> 
 
 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 28</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">appengine-python3-master</span>, 
				under directory <span style="font-style:italic;">lib/cherrypy/cherrypy</span>, 
				in source file <span style="font-style:italic;">_cplogging.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="76990">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="76990">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> reopen_files</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">):</span><span class="pln">
        </span><span class="str">"""Close and reopen all file handlers."""</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> log </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">error_log</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">access_log</span><span class="pun">):</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> h </span><span class="kwd">in</span><span class="pln"> log</span><span class="pun">.</span><span class="pln">handlers</span><span class="pun">:</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> isinstance</span><span class="pun">(</span><span class="pln">h</span><span class="pun">,</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">):</span><span class="pln">
                    h</span><span class="pun">.</span><span class="pln">acquire</span><span class="pun">()</span><span class="pln">
                    h</span><span class="pun">.</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">close</span><span class="pun">()</span><span class="pln">
                    h</span><span class="pun">.</span><span class="pln">stream </span><span class="pun">=</span><span class="pln"> open</span><span class="pun">(</span><span class="pln">h</span><span class="pun">.</span><span class="pln">baseFilename</span><span class="pun">,</span><span class="pln"> h</span><span class="pun">.</span><span class="pln">mode</span><span class="pun">)</span><span class="pln">
                    h</span><span class="pun">.</span><span class="pln">release</span><span class="pun">()</span><span class="pln">

     </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 29</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">BirdBot</span>, 
				under directory <span style="font-style:italic;">birdbot</span>, 
				in source file <span style="font-style:italic;">logger.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="82284">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="82284">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">):</span><span class="pln">
        </span><span class="str">"""Sets up global logging."""</span><span class="pln">
                </span><span class="com"># Logging.</span><span class="pln">
        logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">()</span><span class="pln">
        logger</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">
        short_formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'%(message)s'</span><span class="pun">)</span><span class="pln">

        </span><span class="com"># Print to console.</span><span class="pln">
        console_handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">()</span><span class="pln">
        console_handler</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">)</span><span class="pln">
        console_handler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">short_formatter</span><span class="pun">)</span><span class="pln">
        logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">console_handler</span><span class="pun">)</span><span class="pln">

        </span><span class="com"># Print to file.</span><span class="pln">
        file_handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'../birdbot.log'</span><span class="pun">)</span><span class="pln">
        long_formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'%(asctime)s - %(message)s'</span><span class="pun">)</span><span class="pln">
        file_handler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">long_formatter</span><span class="pun">)</span><span class="pln">
        logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">file_handler</span><span class="pun">)</span><span class="pln">

 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 30</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">gae-django-sandbox</span>, 
				under directory <span style="font-style:italic;">hawaiigaragesale</span>, 
				in source file <span style="font-style:italic;">log.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="88773">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="88773">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> getlogger</span><span class="pun">():</span><span class="pln">
    logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">()</span><span class="pln">
</span><span class="com">#    hdlr = logging.</span><span class="highlight"><span class="com">FileHandler</span></span><span class="com">(settings.LOG_FILE)</span><span class="pln">
</span><span class="com">#    hdlr = logging.</span><span class="highlight"><span class="com">FileHandler</span></span><span class="com">("/tmp/django-log.txt")</span><span class="pln">
    formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'[%(asctime)s]%(levelname)-8s"%(message)s"'</span><span class="pun">,</span><span class="str">'%Y-%m-%d %a %H:%M:%S'</span><span class="pun">)</span><span class="pln"> 
    
</span><span class="com">#    hdlr.setFormatter(formatter)</span><span class="pln">
</span><span class="com">#    logger.addHandler(hdlr)</span><span class="pln">
    logger</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">return</span><span class="pln"> logger

 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 31</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">galaxy-beta1-master</span>, 
				under directory <span style="font-style:italic;">lib/galaxy/webapps/demo_sequencer</span>, 
				in source file <span style="font-style:italic;">config.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="111395">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="111395">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> configure_logging</span><span class="pun">(</span><span class="pln"> config </span><span class="pun">):</span><span class="pln">
    </span><span class="str">"""
    Allow some basic logging configuration to be read from the cherrpy
    config.
    """</span><span class="pln">
    </span><span class="com"># PasteScript will have already configured the logger if the appropriate</span><span class="pln">
    </span><span class="com"># sections were found in the config file, so we do nothing if the</span><span class="pln">
    </span><span class="com"># config has a loggers section, otherwise we do some simple setup</span><span class="pln">
    </span><span class="com"># using the 'log_*' values from the config.</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> config</span><span class="pun">.</span><span class="pln">global_conf_parser</span><span class="pun">.</span><span class="pln">has_section</span><span class="pun">(</span><span class="pln"> </span><span class="str">"loggers"</span><span class="pln"> </span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln">
    format </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln"> </span><span class="str">"log_format"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"%(name)s %(levelname)s %(asctime)s %(message)s"</span><span class="pln"> </span><span class="pun">)</span><span class="pln">
    level </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">_levelNames</span><span class="pun">[</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln"> </span><span class="str">"log_level"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"DEBUG"</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">]</span><span class="pln">
    destination </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln"> </span><span class="str">"log_destination"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"stdout"</span><span class="pln"> </span><span class="pun">)</span><span class="pln">
    log</span><span class="pun">.</span><span class="pln">info</span><span class="pun">(</span><span class="pln"> </span><span class="str">"Logging at '%s' level to '%s'"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> level</span><span class="pun">,</span><span class="pln"> destination </span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span><span class="pln">
    </span><span class="com"># Get root logger</span><span class="pln">
    root </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">()</span><span class="pln">
    </span><span class="com"># Set level</span><span class="pln">
    root</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln"> level </span><span class="pun">)</span><span class="pln">
    </span><span class="com"># Turn down paste httpserver logging</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> level </span><span class="pun">&lt;=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">:</span><span class="pln">
        logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="pln"> </span><span class="str">"paste.httpserver.ThreadPool"</span><span class="pln"> </span><span class="pun">).</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">WARN </span><span class="pun">)</span><span class="pln">
    </span><span class="com"># Remove old handlers</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> h </span><span class="kwd">in</span><span class="pln"> root</span><span class="pun">.</span><span class="pln">handlers</span><span class="pun">[:]:</span><span class="pln">
        root</span><span class="pun">.</span><span class="pln">removeHandler</span><span class="pun">(</span><span class="pln">h</span><span class="pun">)</span><span class="pln">
    </span><span class="com"># Create handler</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> destination </span><span class="pun">==</span><span class="pln"> </span><span class="str">"stdout"</span><span class="pun">:</span><span class="pln">
        handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">(</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">stdout </span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="pln"> destination </span><span class="pun">)</span><span class="pln">
    </span><span class="com"># Create formatter</span><span class="pln">
    formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="pln"> format </span><span class="pun">)</span><span class="pln">
    </span><span class="com"># Hook everything up</span><span class="pln">
    handler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln"> formatter </span><span class="pun">)</span><span class="pln">
    root</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln"> handler </span><span class="pun">)</span><span class="pln">
 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 32</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">galaxy-beta1-master</span>, 
				under directory <span style="font-style:italic;">lib/galaxy/webapps/reports</span>, 
				in source file <span style="font-style:italic;">config.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="111435">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="111435">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> configure_logging</span><span class="pun">(</span><span class="pln"> config </span><span class="pun">):</span><span class="pln">
    </span><span class="str">"""
    Allow some basic logging configuration to be read from the cherrpy
    config.
    """</span><span class="pln">
    format </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln"> </span><span class="str">"log_format"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"%(name)s %(levelname)s %(asctime)s %(message)s"</span><span class="pln"> </span><span class="pun">)</span><span class="pln">
    level </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">_levelNames</span><span class="pun">[</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln"> </span><span class="str">"log_level"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"DEBUG"</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">]</span><span class="pln">
    destination </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln"> </span><span class="str">"log_destination"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"stdout"</span><span class="pln"> </span><span class="pun">)</span><span class="pln">
    log</span><span class="pun">.</span><span class="pln">info</span><span class="pun">(</span><span class="pln"> </span><span class="str">"Logging at '%s' level to '%s'"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> level</span><span class="pun">,</span><span class="pln"> destination </span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span><span class="pln">
    </span><span class="com"># Get root logger</span><span class="pln">
    root </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">()</span><span class="pln">
    </span><span class="com"># Set level</span><span class="pln">
    root</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln"> level </span><span class="pun">)</span><span class="pln">
    </span><span class="com"># Turn down paste httpserver logging</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> level </span><span class="pun">&lt;=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">:</span><span class="pln">
        logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="pln"> </span><span class="str">"paste.httpserver.ThreadPool"</span><span class="pln"> </span><span class="pun">).</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">WARN </span><span class="pun">)</span><span class="pln">
    </span><span class="com"># Remove old handlers</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> h </span><span class="kwd">in</span><span class="pln"> root</span><span class="pun">.</span><span class="pln">handlers</span><span class="pun">[:]:</span><span class="pln">
        root</span><span class="pun">.</span><span class="pln">removeHandler</span><span class="pun">(</span><span class="pln">h</span><span class="pun">)</span><span class="pln">
    </span><span class="com"># Create handler</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> destination </span><span class="pun">==</span><span class="pln"> </span><span class="str">"stdout"</span><span class="pun">:</span><span class="pln">
        handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">(</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">stdout </span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="pln"> destination </span><span class="pun">)</span><span class="pln">
    </span><span class="com"># Create formatter</span><span class="pln">
    formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="pln"> format </span><span class="pun">)</span><span class="pln">
    </span><span class="com"># Hook everything up</span><span class="pln">
    handler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln"> formatter </span><span class="pun">)</span><span class="pln">
    root</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln"> handler </span><span class="pun">)</span><span class="pln">


 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 33</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">morse</span>, 
				under directory <span style="font-style:italic;">src/morse/testing</span>, 
				in source file <span style="font-style:italic;">testing.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="138466">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="138466">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> setup_logging</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">):</span><span class="pln">
        </span><span class="com"># get the top logger</span><span class="pln">
        logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="str">'morsetesting'</span><span class="pun">)</span><span class="pln">
        logger</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">

        ch </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">"testing.log"</span><span class="pun">)</span><span class="pln">
        ch</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">

        formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'[%(asctime)s %(name)s (%(levelname)s)]   %(message)s'</span><span class="pun">)</span><span class="pln">

        ch</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">

        logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">ch</span><span class="pun">)</span><span class="pln">
        


     </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 34</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">kaa</span>, 
				under directory <span style="font-style:italic;">beacon/src</span>, 
				in source file <span style="font-style:italic;">fusefs.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="143185">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="143185">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> main</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">):</span><span class="pln">
        </span><span class="str">"""
        Main loop for fuse. This needs to be called in a thread. On fuse
        shutdown, the kaa main loop will be stopped.
        """</span><span class="pln">

        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">True</span><span class="pun">:</span><span class="pln">
            </span><span class="com"># activate for debugging to see a logfile in /tmp/fuselog</span><span class="pln">
            handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'/tmp/fuselog'</span><span class="pun">)</span><span class="pln">
            f </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'%(filename)s %(lineno)s: %(message)s'</span><span class="pun">)</span><span class="pln">
            handler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">f</span><span class="pun">)</span><span class="pln">
            log</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">handler</span><span class="pun">)</span><span class="pln">
            log</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">)</span><span class="pln">

        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">check</span><span class="pun">()</span><span class="pln">
        fuse</span><span class="pun">.</span><span class="typ">Fuse</span><span class="pun">.</span><span class="pln">main</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">)</span><span class="pln">
        kaa</span><span class="pun">.</span><span class="typ">MainThreadCallable</span><span class="pun">(</span><span class="pln">kaa</span><span class="pun">.</span><span class="pln">main</span><span class="pun">.</span><span class="pln">stop</span><span class="pun">)()</span><span class="pln">
 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 35</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">cloudrouter-master</span>, 
				under directory <span style="font-style:italic;">testing/core/peering-test1</span>, 
				in source file <span style="font-style:italic;">runtest.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="147581">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="147581">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln">debug</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">testresults </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">testdesc </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">allpass </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">debug</span><span class="pun">=</span><span class="pln">debug
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="str">'MyLogger'</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">logger</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">loghandler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'/tmp/coretest.log'</span><span class="pun">,</span><span class="pln">mode</span><span class="pun">=</span><span class="str">'w'</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">loghandler</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">loghandler</span><span class="pun">)</span><span class="pln">

        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">debug </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">True</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">console </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">()</span><span class="pln">
            </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">console</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">console</span><span class="pun">)</span><span class="pln">


     </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 36</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">learnit--master</span>, 
				under directory <span style="font-style:italic;"></span>, 
				in source file <span style="font-style:italic;">learnit2.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 10				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="147698">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="147698">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln"> opener</span><span class="pun">):</span><span class="pln">
      </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">opener </span><span class="pun">=</span><span class="pln"> opener
      </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="str">'weblogger'</span><span class="pun">)</span><span class="pln">
      </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">logger</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">
      </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'log'</span><span class="pun">))</span><span class="pln">
    </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 37</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">gfrd</span>, 
				under directory <span style="font-style:italic;"></span>, 
				in source file <span style="font-style:italic;">log.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 8				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="17350">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="17350">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> setupLogging</span><span class="pun">():</span><span class="pln">
    </span><span class="str">"""This logging faciliy can be used for info en debug messages and such.

    Usage:
        * from log import *
        * log.info( 'foo' )
        * log.debug( 'bar' )

    """</span><span class="pln">
    </span><span class="kwd">global</span><span class="pln"> log 

    log </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="pln"> </span><span class="str">'pdpp'</span><span class="pln"> </span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> </span><span class="str">'LOGFILE'</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">environ</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="str">'LOGSIZE'</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">environ </span><span class="kwd">and</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">environ</span><span class="pun">[</span><span class="pln"> </span><span class="str">'LOGSIZE'</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
            handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">handlers</span><span class="pun">.</span><span class="pln">\
                </span><span class="typ">RotatingFileHandler</span><span class="pun">(</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">environ</span><span class="pun">[</span><span class="pln"> </span><span class="str">'LOGFILE'</span><span class="pln"> </span><span class="pun">],</span><span class="pln"> mode</span><span class="pun">=</span><span class="str">'w'</span><span class="pun">,</span><span class="pln">
                                     maxBytes</span><span class="pun">=</span><span class="kwd">int</span><span class="pun">(</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">environ</span><span class="pun">[</span><span class="pln"> </span><span class="str">'LOGSIZE'</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">environ</span><span class="pun">[</span><span class="pln"> </span><span class="str">'LOGFILE'</span><span class="pln"> </span><span class="pun">],</span><span class="pln"> </span><span class="str">'w'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">)</span><span class="pln">
            
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">(</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">stdout </span><span class="pun">)</span><span class="pln">

    formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="pln"> </span><span class="str">'%(message)s'</span><span class="pln"> </span><span class="pun">)</span><span class="pln">
    handler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln"> formatter </span><span class="pun">)</span><span class="pln">
    log</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln"> handler </span><span class="pun">)</span><span class="pln">
        
    LOGLEVELS </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="str">'CRITICAL'</span><span class="pun">:</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">CRITICAL</span><span class="pun">,</span><span class="pln">
                  </span><span class="str">'ERROR'</span><span class="pun">:</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">ERROR</span><span class="pun">,</span><span class="pln">
                  </span><span class="str">'WARNING'</span><span class="pun">:</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">WARNING</span><span class="pun">,</span><span class="pln">
                  </span><span class="str">'INFO'</span><span class="pun">:</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">,</span><span class="pln"> 
                  </span><span class="str">'DEBUG'</span><span class="pun">:</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">,</span><span class="pln"> 
                  </span><span class="str">'NOTSET'</span><span class="pun">:</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">NOTSET </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> </span><span class="str">'LOGLEVEL'</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">environ</span><span class="pun">:</span><span class="pln">
        log</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln"> LOGLEVELS</span><span class="pun">[</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">environ</span><span class="pun">[</span><span class="pln"> </span><span class="str">'LOGLEVEL'</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        log</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">INFO </span><span class="pun">)</span><span class="pln">


 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 38</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">cmp</span>, 
				under directory <span style="font-style:italic;">cmp</span>, 
				in source file <span style="font-style:italic;">logme.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 8				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="23842">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="23842">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> getLog</span><span class="pun">(</span><span class="pln">fpath</span><span class="pun">):</span><span class="pln">
    logFormat </span><span class="pun">=</span><span class="pln"> </span><span class="str">"%(levelname)-8s : %(asctime)s : %(name)-10s : %(message)s"</span><span class="pln">
    logFormatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="pln"> logFormat </span><span class="pun">)</span><span class="pln">
    
    consolehandler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">()</span><span class="pln">
    consolehandler</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">DEBUG </span><span class="pun">)</span><span class="pln">
    consolehandler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln"> logFormatter </span><span class="pun">)</span><span class="pln">
    
    </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> op</span><span class="pun">.</span><span class="pln">exists</span><span class="pun">(</span><span class="pln">fpath</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">try</span><span class="pun">:</span><span class="pln">
            os</span><span class="pun">.</span><span class="pln">makedirs</span><span class="pun">(</span><span class="pln">op</span><span class="pun">.</span><span class="pln">dirname</span><span class="pun">(</span><span class="pln">fpath</span><span class="pun">))</span><span class="pln">
        </span><span class="kwd">except</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">pass</span><span class="pln">

    errfpath </span><span class="pun">=</span><span class="pln"> fpath </span><span class="pun">+</span><span class="pln"> </span><span class="str">'.error'</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> op</span><span class="pun">.</span><span class="pln">exists</span><span class="pun">(</span><span class="pln">errfpath</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">try</span><span class="pun">:</span><span class="pln">
            os</span><span class="pun">.</span><span class="pln">makedirs</span><span class="pun">(</span><span class="pln">op</span><span class="pun">.</span><span class="pln">dirname</span><span class="pun">(</span><span class="pln">errfpath</span><span class="pun">))</span><span class="pln">
        </span><span class="kwd">except</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">pass</span><span class="pln">

    logFile </span><span class="pun">=</span><span class="pln"> fpath
    logFileErr </span><span class="pun">=</span><span class="pln"> errfpath
    
    filehandler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="pln"> logFile </span><span class="pun">)</span><span class="pln">
    filehandler</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">DEBUG </span><span class="pun">)</span><span class="pln">
    filehandler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln"> logFormatter </span><span class="pun">)</span><span class="pln">

    filehandler2 </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="pln"> logFileErr </span><span class="pun">)</span><span class="pln">
    filehandler2</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">ERROR </span><span class="pun">)</span><span class="pln">
    filehandler2</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln"> logFormatter </span><span class="pun">)</span><span class="pln">

    logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="pln"> </span><span class="str">''</span><span class="pln"> </span><span class="pun">).</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln"> consolehandler </span><span class="pun">)</span><span class="pln">
    logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="pln"> </span><span class="str">''</span><span class="pln"> </span><span class="pun">).</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln"> filehandler </span><span class="pun">)</span><span class="pln">
    logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="pln"> </span><span class="str">''</span><span class="pln"> </span><span class="pun">).</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln"> filehandler2 </span><span class="pun">)</span><span class="pln">
    
    mainlog </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="pln"> </span><span class="str">"main"</span><span class="pln"> </span><span class="pun">)</span><span class="pln">
    mainlog</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">DEBUG </span><span class="pun">)</span><span class="pln">
    
    </span><span class="kwd">return</span><span class="pln"> mainlog

 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 39</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">relais.dev</span>, 
				under directory <span style="font-style:italic;">relais/dev</span>, 
				in source file <span style="font-style:italic;">simplelog.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 8				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="131745">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="131745">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> make_logger </span><span class="pun">(</span><span class="pln">name</span><span class="pun">=</span><span class="kwd">None</span><span class="pun">,</span><span class="pln"> handler</span><span class="pun">=</span><span class="kwd">None</span><span class="pun">,</span><span class="pln"> filemode</span><span class="pun">=</span><span class="kwd">None</span><span class="pun">,</span><span class="pln">
   msg_fmt</span><span class="pun">=</span><span class="kwd">None</span><span class="pun">,</span><span class="pln"> date_fmt</span><span class="pun">=</span><span class="kwd">None</span><span class="pun">,</span><span class="pln"> level</span><span class="pun">=</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">):</span><span class="pln">
   </span><span class="str">"""
   Return a basic logger.

   The default behaviour is to create a logger 'relais' that send every
   message to stderr, labelled with the date-time, name and level. This serves
   as the basis for all other loggers.

   :Parameters:
      name
         The title of the logger ('relais' by default).
      handler
         The destination of the messages. If not defined, it is set to stderr.
         If a string, this is interpreted as the path of a file to log to.
         Otherwise, it treated as a Handler object for the logger.
      filemode
         The filemode for the file handler created if the `handler` param is
         a file path.
      msg_fmt
         The format to use for displaying messages. Defaults to showing the
         date-time, name and level.
      date_fmt
         How to display the date, defaults to international format.
      level
         What messages to display. Displays to all.

   For example::

      &gt;&gt;&gt; lgr = make_logger()
      &gt;&gt;&gt; lgr.info ("</span><span class="pln">what</span><span class="pun">?</span><span class="str">")

   """</span><span class="pln">
   </span><span class="com"># if no logger name is given, set it to current script</span><span class="pln">
   </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">name </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">):</span><span class="pln">
      name </span><span class="pun">=</span><span class="pln"> </span><span class="str">'relais'</span><span class="pln">

   </span><span class="com"># if no handler given, set to stdout</span><span class="pln">
   </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">handler </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">):</span><span class="pln">
      handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">()</span><span class="pln">
   </span><span class="com"># else if handler is a string, assume it's a filepath</span><span class="pln">
   </span><span class="kwd">elif</span><span class="pln"> </span><span class="pun">(</span><span class="pln">type </span><span class="pun">(</span><span class="pln">handler</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> type </span><span class="pun">(</span><span class="str">''</span><span class="pun">)):</span><span class="pln">
      </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">filemode </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">):</span><span class="pln">
         filemode </span><span class="pun">=</span><span class="pln"> </span><span class="str">'w+'</span><span class="pln">
      handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pln"> </span><span class="pun">(</span><span class="pln">handler</span><span class="pun">,</span><span class="pln"> filemode</span><span class="pun">)</span><span class="pln">
   </span><span class="com"># otherwise assume it's a handler</span><span class="pln">

   </span><span class="com"># set up message format</span><span class="pln">
   </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">msg_fmt </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">):</span><span class="pln">
      msg_fmt </span><span class="pun">=</span><span class="pln"> </span><span class="str">'%(asctime)s %(name)-8s %(levelname)s: %(message)s'</span><span class="pln">
   </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">date_fmt </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">):</span><span class="pln">
      date_fmt </span><span class="pun">=</span><span class="pln"> </span><span class="str">'%Y-%m-%d %H:%M:%S'</span><span class="pln">
   formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pln"> </span><span class="pun">(</span><span class="pln">msg_fmt</span><span class="pun">,</span><span class="pln"> date_fmt</span><span class="pun">)</span><span class="pln">
   handler</span><span class="pun">.</span><span class="pln">setFormatter </span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">

   </span><span class="com"># create and init logger</span><span class="pln">
   logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger </span><span class="pun">(</span><span class="pln">name</span><span class="pun">)</span><span class="pln">
   logger</span><span class="pun">.</span><span class="pln">setLevel </span><span class="pun">(</span><span class="pln">level</span><span class="pun">)</span><span class="pln">
   logger</span><span class="pun">.</span><span class="pln">addHandler </span><span class="pun">(</span><span class="pln">handler</span><span class="pun">)</span><span class="pln">

   </span><span class="kwd">return</span><span class="pln"> logger


 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 40</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">adv-net-samples-master</span>, 
				under directory <span style="font-style:italic;">sdn/pox/pox/log</span>, 
				in source file <span style="font-style:italic;">__init__.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 5				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="3470">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="3470">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> launch </span><span class="pun">(</span><span class="pln">__INSTANCE__ </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">,</span><span class="pln"> </span><span class="pun">**</span><span class="pln">kw</span><span class="pun">):</span><span class="pln">
  </span><span class="str">"""
  Allows you to configure log handlers from the commandline.

  Examples:
   ./pox.py log --file=pox.log,w --syslog --no-default
   ./pox.py log --*TimedRotatingFile=filename=foo.log,when=D,backupCount=5

  The handlers are most of the ones described in Python's logging.handlers,
  and the special one --no-default, which turns off the default logging to
  stderr.

  Arguments are passed positionally by default.  A leading * makes them pass
  by keyword.

  If a --format="&lt;str&gt;" is specified, it is used as a format string for a
  logging.Formatter instance for all loggers created with that invocation
  of the log module.  If no loggers are created with this instantiation,
  it is used for the default logger.
  If a --format is specified, you can also specify a --datefmt="&lt;str&gt;"
  where the string is a strftime format string for date/time stamps.
  """</span><span class="pln">

  </span><span class="kwd">if</span><span class="pln"> </span><span class="str">'format'</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> kw</span><span class="pun">:</span><span class="pln">
    df </span><span class="pun">=</span><span class="pln"> kw</span><span class="pun">.</span><span class="pln">pop</span><span class="pun">(</span><span class="str">"datefmt"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">)</span><span class="pln">
    formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="pln">kw</span><span class="pun">[</span><span class="str">'format'</span><span class="pun">],</span><span class="pln"> datefmt</span><span class="pun">=</span><span class="pln">df</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">del</span><span class="pln"> kw</span><span class="pun">[</span><span class="str">'format'</span><span class="pun">]</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">kw</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
      </span><span class="com"># Use for the default logger...</span><span class="pln">
      </span><span class="kwd">import</span><span class="pln"> pox</span><span class="pun">.</span><span class="pln">core
      pox</span><span class="pun">.</span><span class="pln">core</span><span class="pun">.</span><span class="pln">_default_log_handler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
  </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
    formatter </span><span class="pun">=</span><span class="pln"> _formatter

  </span><span class="kwd">def</span><span class="pln"> standard </span><span class="pun">(</span><span class="pln">use_kw</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> C</span><span class="pun">):</span><span class="pln">
    </span><span class="com"># Should use a better function than split, which understands</span><span class="pln">
    </span><span class="com"># quotes and the like.</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> v </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">True</span><span class="pun">:</span><span class="pln">
      h </span><span class="pun">=</span><span class="pln"> C</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
      v </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">_parse</span><span class="pun">(</span><span class="pln">p</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> p </span><span class="kwd">in</span><span class="pln"> v</span><span class="pun">.</span><span class="pln">split</span><span class="pun">(</span><span class="str">','</span><span class="pun">)]</span><span class="pln">
      </span><span class="kwd">if</span><span class="pln"> use_kw</span><span class="pun">:</span><span class="pln">
        v </span><span class="pun">=</span><span class="pln"> dict</span><span class="pun">([</span><span class="pln">x</span><span class="pun">.</span><span class="pln">split</span><span class="pun">(</span><span class="str">'='</span><span class="pun">,</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> v</span><span class="pun">])</span><span class="pln">
        h </span><span class="pun">=</span><span class="pln"> C</span><span class="pun">(**</span><span class="pln">v</span><span class="pun">)</span><span class="pln">
      </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        h </span><span class="pun">=</span><span class="pln"> C</span><span class="pun">(*</span><span class="pln">v</span><span class="pun">)</span><span class="pln">
    h</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
    logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">().</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">h</span><span class="pun">)</span><span class="pln">

  </span><span class="kwd">for</span><span class="pln"> _k</span><span class="pun">,</span><span class="pln">v </span><span class="kwd">in</span><span class="pln"> kw</span><span class="pun">.</span><span class="pln">iteritems</span><span class="pun">():</span><span class="pln">
    k </span><span class="pun">=</span><span class="pln"> _k
    use_kw </span><span class="pun">=</span><span class="pln"> k</span><span class="pun">.</span><span class="pln">startswith</span><span class="pun">(</span><span class="str">"*"</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> use_kw</span><span class="pun">:</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> k</span><span class="pun">[</span><span class="lit">1</span><span class="pun">:]</span><span class="pln">
    k </span><span class="pun">=</span><span class="pln"> k</span><span class="pun">.</span><span class="pln">lower</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> k </span><span class="pun">==</span><span class="pln"> </span><span class="str">"no_default"</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> v</span><span class="pun">:</span><span class="pln">
      </span><span class="kwd">import</span><span class="pln"> pox</span><span class="pun">.</span><span class="pln">core
      logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">().</span><span class="pln">removeHandler</span><span class="pun">(</span><span class="pln">pox</span><span class="pun">.</span><span class="pln">core</span><span class="pun">.</span><span class="pln">_default_log_handler</span><span class="pun">)</span><span class="pln">
      logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">().</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="typ">NullHandler</span><span class="pun">())</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> k </span><span class="pun">==</span><span class="pln"> </span><span class="str">"stderr"</span><span class="pun">:</span><span class="pln">
      standard</span><span class="pun">(</span><span class="pln">use_kw</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">())</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> k </span><span class="pun">==</span><span class="pln"> </span><span class="str">"stdout"</span><span class="pun">:</span><span class="pln">
      </span><span class="kwd">import</span><span class="pln"> sys
      standard</span><span class="pun">(</span><span class="pln">use_kw</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">(</span><span class="pln">sys</span><span class="pun">.</span><span class="pln">stdout</span><span class="pun">))</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> k </span><span class="pun">==</span><span class="pln"> </span><span class="str">"file"</span><span class="pun">:</span><span class="pln">
      standard</span><span class="pun">(</span><span class="pln">use_kw</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> k </span><span class="pun">==</span><span class="pln"> </span><span class="str">"watchedfile"</span><span class="pun">:</span><span class="pln">
      standard</span><span class="pun">(</span><span class="pln">use_kw</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WatchedFileHandler</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> k </span><span class="pun">==</span><span class="pln"> </span><span class="str">"rotatingfile"</span><span class="pun">:</span><span class="pln">
      standard</span><span class="pun">(</span><span class="pln">use_kw</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="typ">RotatingFileHandler</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> k </span><span class="pun">==</span><span class="pln"> </span><span class="str">"timedrotatingfile"</span><span class="pun">:</span><span class="pln">
      standard</span><span class="pun">(</span><span class="pln">use_kw</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="typ">TimedRotatingFileHandler</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> k </span><span class="pun">==</span><span class="pln"> </span><span class="str">"socket"</span><span class="pun">:</span><span class="pln">
      standard</span><span class="pun">(</span><span class="pln">use_kw</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="typ">SocketHandler</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> k </span><span class="pun">==</span><span class="pln"> </span><span class="str">"datagram"</span><span class="pun">:</span><span class="pln">
      standard</span><span class="pun">(</span><span class="pln">use_kw</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="typ">DatagramHandler</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> k </span><span class="pun">==</span><span class="pln"> </span><span class="str">"syslog"</span><span class="pun">:</span><span class="pln">
      </span><span class="kwd">if</span><span class="pln"> v </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">True</span><span class="pun">:</span><span class="pln">
        v </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
        use_kw </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
      </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        v </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">_parse</span><span class="pun">(</span><span class="pln">p</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> p </span><span class="kwd">in</span><span class="pln"> v</span><span class="pun">.</span><span class="pln">split</span><span class="pun">(</span><span class="str">','</span><span class="pun">)]</span><span class="pln">
      </span><span class="kwd">if</span><span class="pln"> use_kw</span><span class="pun">:</span><span class="pln">
        v </span><span class="pun">=</span><span class="pln"> dict</span><span class="pun">([</span><span class="pln">x</span><span class="pun">.</span><span class="pln">split</span><span class="pun">(</span><span class="str">'='</span><span class="pun">,</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> v</span><span class="pun">])</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="str">'address'</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> v </span><span class="kwd">or</span><span class="pln"> </span><span class="str">'port'</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> v</span><span class="pun">:</span><span class="pln">
          address </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="str">'localhost'</span><span class="pun">,</span><span class="pln"> SYSLOG_UDP_PORT</span><span class="pun">)</span><span class="pln">
          v</span><span class="pun">[</span><span class="str">'address'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'address'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'localhost'</span><span class="pun">),</span><span class="pln">
                          v</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'port'</span><span class="pun">,</span><span class="pln"> SYSLOG_UDP_PORT</span><span class="pun">))</span><span class="pln">
          </span><span class="kwd">if</span><span class="pln"> </span><span class="str">'port'</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> v</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">del</span><span class="pln"> v</span><span class="pun">[</span><span class="str">'port'</span><span class="pun">]</span><span class="pln">
        </span><span class="kwd">elif</span><span class="pln"> </span><span class="str">'address'</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">''</span><span class="pln"> </span><span class="kwd">or</span><span class="pln"> </span><span class="str">'address'</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'*'</span><span class="pun">:</span><span class="pln">
          v</span><span class="pun">[</span><span class="str">'address'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">'/dev/log'</span><span class="pln">
        h </span><span class="pun">=</span><span class="pln"> </span><span class="typ">SysLogHandler</span><span class="pun">(**</span><span class="pln">v</span><span class="pun">)</span><span class="pln">
      </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">:</span><span class="pln">
          v</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> v</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span><span class="pln">
          </span><span class="kwd">del</span><span class="pln"> v</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln">
        </span><span class="kwd">elif</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
          </span><span class="kwd">if</span><span class="pln"> v</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">''</span><span class="pln"> </span><span class="kwd">or</span><span class="pln"> v</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'*'</span><span class="pun">:</span><span class="pln">
            v</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">'/dev/log'</span><span class="pln">
          </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            v</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v</span><span class="pun">[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> SYSLOG_UDP_PORT</span><span class="pun">)</span><span class="pln">
        h </span><span class="pun">=</span><span class="pln"> </span><span class="typ">SysLogHandler</span><span class="pun">(*</span><span class="pln">v</span><span class="pun">)</span><span class="pln">
      logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">().</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">h</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> k </span><span class="pun">==</span><span class="pln"> </span><span class="str">"http"</span><span class="pun">:</span><span class="pln">
      standard</span><span class="pun">(</span><span class="pln">use_kw</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="typ">HTTPHandler</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
      </span><span class="kwd">raise</span><span class="pln"> </span><span class="typ">TypeError</span><span class="pun">(</span><span class="str">"Invalid argument: "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> _k</span><span class="pun">)</span><span class="pln">
 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 41</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">BC2Monitor</span>, 
				under directory <span style="font-style:italic;"></span>, 
				in source file <span style="font-style:italic;">monitor3.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 5				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="75644">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="75644">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">isfile</span><span class="pun">(</span><span class="pln">os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="str">''</span><span class="pun">,</span><span class="pln"> </span><span class="str">'.monitor.lock'</span><span class="pun">)):</span><span class="pln">
            </span><span class="kwd">print</span><span class="pln"> </span><span class="str">'Instance of monitor already running...'</span><span class="pln">
            sys</span><span class="pun">.</span><span class="kwd">exit</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            f </span><span class="pun">=</span><span class="pln"> open</span><span class="pun">(</span><span class="pln">os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="str">''</span><span class="pun">,</span><span class="pln"> </span><span class="str">'.monitor.lock'</span><span class="pun">),</span><span class="pln"> </span><span class="str">'w'</span><span class="pun">)</span><span class="pln">
            f</span><span class="pun">.</span><span class="pln">write</span><span class="pun">(</span><span class="str">'running!'</span><span class="pun">)</span><span class="pln">
            f</span><span class="pun">.</span><span class="pln">close</span><span class="pun">()</span><span class="pln">
            
        </span><span class="com">#are we running? hah!</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">running </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln">
        </span><span class="com">#set up the loggers</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="str">'chatlog'</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">logger</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">)</span><span class="pln">
        ch </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'chatlog.txt'</span><span class="pun">)</span><span class="pln">
        ch</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">)</span><span class="pln">
        formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">"%(asctime)s - %(message)s"</span><span class="pun">)</span><span class="pln">
        ch</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">ch</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">log </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="str">'gamelog'</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">log</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">)</span><span class="pln">
        ch </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'logfile.txt'</span><span class="pun">)</span><span class="pln">
        ch</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">)</span><span class="pln">
        formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="kwd">None</span><span class="pun">)</span><span class="pln">
        ch</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">log</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">ch</span><span class="pun">)</span><span class="pln">

        </span><span class="com">#read config options</span><span class="pln">
        config </span><span class="pun">=</span><span class="pln"> </span><span class="typ">ConfigParser</span><span class="pun">.</span><span class="typ">ConfigParser</span><span class="pun">()</span><span class="pln">
        config</span><span class="pun">.</span><span class="pln">readfp</span><span class="pun">(</span><span class="pln">open</span><span class="pun">(</span><span class="pln">os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">abspath</span><span class="pun">(</span><span class="str">'.'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">'//config.cfg'</span><span class="pun">))</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">host </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'server'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'ip'</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">port </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'server'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'port'</span><span class="pun">))</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">pw </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'server'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'pass'</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">dbhost </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'mysql'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'host'</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">dbuser </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'mysql'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'user'</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">dbpasswd </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'mysql'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'passwd'</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">dbname </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'mysql'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'db'</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">webip </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'web'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'ip'</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">webport </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'web'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'port'</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">gmail_user </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'email'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'user'</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">gmail_pwd </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'email'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'pass'</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">mail_to </span><span class="pun">=</span><span class="pln"> config</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'email'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'send_to'</span><span class="pun">)</span><span class="pln">
        
        </span><span class="com">#try:</span><span class="pln">
        </span><span class="com">#    self.ip = urllib.urlopen('http://whatismyip.org/').read()</span><span class="pln">
        </span><span class="com">#except:</span><span class="pln">
        </span><span class="com">#    pass</span><span class="pln">
        
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">sqlerror </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">

        </span><span class="kwd">self</span><span class="pun">.</span><span class="typ">PBMessages</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">
            </span><span class="pun">(</span><span class="pln">re</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="pln">r</span><span class="str">'^PunkBuster Server: Running PB Scheduled Task \(slot #(?P&lt;slot&gt;\d+)\)\s+(?P&lt;task&gt;.*)$'</span><span class="pun">),</span><span class="pln"> </span><span class="str">'PBScheduledTask'</span><span class="pun">),</span><span class="pln">
            </span><span class="pun">(</span><span class="pln">re</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="pln">r</span><span class="str">'^PunkBuster Server: Lost Connection \(slot #(?P&lt;slot&gt;\d+)\) (?P&lt;ip&gt;[^:]+):(?P&lt;port&gt;\d+) (?P&lt;pbuid&gt;[^\s]+)\(-\)\s(?P&lt;name&gt;.+)$'</span><span class="pun">),</span><span class="pln"> </span><span class="str">'PBLostConnection'</span><span class="pun">),</span><span class="pln">
            </span><span class="pun">(</span><span class="pln">re</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="pln">r</span><span class="str">'^PunkBuster Server: Master Query Sent to \((?P&lt;pbmaster&gt;[^\s]+)\) (?P&lt;ip&gt;[^:]+)$'</span><span class="pun">),</span><span class="pln"> </span><span class="str">'PBMasterQuerySent'</span><span class="pun">),</span><span class="pln">
            </span><span class="pun">(</span><span class="pln">re</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="pln">r</span><span class="str">'^PunkBuster Server: Player GUID Computed (?P&lt;pbid&gt;[0-9a-fA-F]+)\(-\) \(slot #(?P&lt;slot&gt;\d+)\) (?P&lt;ip&gt;[^:]+):(?P&lt;port&gt;\d+)\s(?P&lt;name&gt;.+)$'</span><span class="pun">),</span><span class="pln"> </span><span class="str">'PBPlayerGuid'</span><span class="pun">),</span><span class="pln">
            </span><span class="pun">(</span><span class="pln">re</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="pln">r</span><span class="str">'^PunkBuster Server: New Connection \(slot #(?P&lt;slot&gt;\d+)\) (?P&lt;ip&gt;[^:]+):(?P&lt;port&gt;\d+) \[(?P&lt;something&gt;[^\s]+)\]\s"(?P&lt;name&gt;.+)".*$'</span><span class="pun">),</span><span class="pln"> </span><span class="str">'PBNewConnection'</span><span class="pun">)</span><span class="pln">
            </span><span class="pun">)</span><span class="pln">

        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">mapnames </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="str">'Panama Canal'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Valparaiso'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Laguna Alta'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Isla Inocentes'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Atacama Desert'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Africa Harbor'</span><span class="pun">,</span><span class="pln">
                    </span><span class="str">'White Pass'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Nelson Bay'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Laguna Presa'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Port Valdez'</span><span class="pun">]</span><span class="pln">
        
        </span><span class="kwd">self</span><span class="pun">.</span><span class="typ">ALLmaps</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="str">'Panama Canal'</span><span class="pun">:</span><span class="str">'MP_001'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Valparioso'</span><span class="pun">:</span><span class="str">'MP_002'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Laguna Alta'</span><span class="pun">:</span><span class="str">'MP_003'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Isla Inocentes'</span><span class="pun">:</span><span class="str">'MP_004'</span><span class="pun">,</span><span class="pln">
               </span><span class="str">'Atacama Desert'</span><span class="pun">:</span><span class="str">'MP_005'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Africa Harbor'</span><span class="pun">:</span><span class="str">'MP_006'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'White Pass'</span><span class="pun">:</span><span class="str">'MP_007'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Nelson Bay'</span><span class="pun">:</span><span class="str">'MP_008'</span><span class="pun">,</span><span class="pln">
               </span><span class="str">'Laguna Presa'</span><span class="pun">:</span><span class="str">'MP_009'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Port Valdez'</span><span class="pun">:</span><span class="str">'MP_012'</span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">CONQUEST </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="str">'Panama Canal'</span><span class="pun">:</span><span class="str">'MP_003'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Atacama Desert'</span><span class="pun">:</span><span class="str">'MP_005'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Africa Harbor'</span><span class="pun">:</span><span class="str">'MP_006CQ'</span><span class="pun">,</span><span class="pln">
                        </span><span class="str">'White Pass'</span><span class="pun">:</span><span class="str">'MP_007'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Laguna Presa'</span><span class="pun">:</span><span class="str">'MP_009CQ'</span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">RUSH </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="str">'Valparaiso'</span><span class="pun">:</span><span class="str">'MP_002'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Isla Inocentes'</span><span class="pun">:</span><span class="str">'MP_004'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Neslon Bay'</span><span class="pun">:</span><span class="str">'MP_008'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Port Valdez'</span><span class="pun">:</span><span class="str">'MP_012GR'</span><span class="pun">,</span><span class="pln">
                   </span><span class="str">'Laguna Presa'</span><span class="pun">:</span><span class="str">'MP_009GR'</span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">SQDM </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="str">'Isla Inocentes'</span><span class="pun">:</span><span class="str">'MP_004SDM'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Africa Harbor'</span><span class="pun">:</span><span class="str">'MP_006SDM'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'White Pass'</span><span class="pun">:</span><span class="str">'MP_007SDM'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Laguna Presa'</span><span class="pun">:</span><span class="str">'MP_009SDM'</span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">SQRUSH </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="str">'Panama Canal'</span><span class="pun">:</span><span class="str">'MP_001SR'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Valparaiso'</span><span class="pun">:</span><span class="str">'MP_002SR'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Atacama Desert'</span><span class="pun">:</span><span class="str">'MP_005SR'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Port Valdez'</span><span class="pun">:</span><span class="str">'MP_012SR'</span><span class="pun">}</span><span class="pln">
        
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">commands </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="str">'!rules'</span><span class="pun">:</span><span class="str">'Show the server rules to player'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'!help'</span><span class="pun">:</span><span class="pln"> </span><span class="str">'Show player general help.  Takes optional argument command for specific help'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'!stats'</span><span class="pun">:</span><span class="str">'Show all players kills, deaths, and ratio for player'</span><span class="pun">,</span><span class="pln"> 
                        </span><span class="str">'!chuck'</span><span class="pun">:</span><span class="str">'Show all players a random Chuck Norris message'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'!punish'</span><span class="pun">:</span><span class="str">'Required argument [player].  Kills [player] and displays attention getting message'</span><span class="pun">,</span><span class="pln"> 
                        </span><span class="str">'!map'</span><span class="pun">:</span><span class="str">'Required argument [map].  Changes map to [map] with immediate effect.'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'!restart'</span><span class="pun">:</span><span class="str">'Restarts current map'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'!kick'</span><span class="pun">:</span><span class="str">'Required arguments [player],[time],and [reason] Kicks [player] for [time] for [reason]'</span><span class="pun">,</span><span class="pln">
                        </span><span class="str">'!ban'</span><span class="pun">:</span><span class="str">'Required arguments [player] and [reason].  Bans [player] for [reason]'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'!gametype'</span><span class="pun">:</span><span class="str">'Required argument [gametype].  Changes server to [gametype] with immediate effect.'</span><span class="pun">}</span><span class="pln">
        
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">command </span><span class="pun">=</span><span class="pln"> re</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="pln">r</span><span class="str">'^(?P&lt;cid&gt;\'[^\']{2,}\'|[0-9]+|[^\s]{2,}|@[0-9]+)\s?(?P&lt;parms&gt;.*)$'</span><span class="pun">,</span><span class="pln"> re</span><span class="pun">.</span><span class="pln">I</span><span class="pun">)</span><span class="pln">

        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">players </span><span class="pun">=</span><span class="pln"> clients</span><span class="pun">.</span><span class="pln">clients</span><span class="pun">()</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">queue </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Queue</span><span class="pun">.</span><span class="typ">Queue</span><span class="pun">()</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">chat </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">kills </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">map </span><span class="pun">=</span><span class="pln"> </span><span class="str">''</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">round </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="str">'0'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">]</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">scores </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">pcount </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">serverrank </span><span class="pun">=</span><span class="pln"> </span><span class="str">''</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">serverperc </span><span class="pun">=</span><span class="pln"> </span><span class="str">''</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">gametype </span><span class="pun">=</span><span class="pln"> </span><span class="str">'None'</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">rc </span><span class="pun">=</span><span class="pln"> rcon</span><span class="pun">.</span><span class="typ">RCon</span><span class="pun">()</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">eventmon </span><span class="pun">=</span><span class="pln"> rcon</span><span class="pun">.</span><span class="typ">RCon</span><span class="pun">()</span><span class="pln">

        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">badwords </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
        </span><span class="kwd">with</span><span class="pln"> open</span><span class="pun">(</span><span class="str">'badwords.txt'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'r'</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> f</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> line </span><span class="kwd">in</span><span class="pln"> f</span><span class="pun">:</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> line</span><span class="pun">:</span><span class="pln">
                    </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">badwords</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">line</span><span class="pun">.</span><span class="pln">strip</span><span class="pun">(</span><span class="str">'\n'</span><span class="pun">))</span><span class="pln">
        
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">banwords </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
        </span><span class="kwd">with</span><span class="pln"> open</span><span class="pun">(</span><span class="str">'banlist.txt'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'r'</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> f</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> line </span><span class="kwd">in</span><span class="pln"> f</span><span class="pun">:</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> line</span><span class="pun">:</span><span class="pln">
                    </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">banwords</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">line</span><span class="pun">.</span><span class="pln">strip</span><span class="pun">(</span><span class="str">'\n'</span><span class="pun">))</span><span class="pln">
        
        eq </span><span class="pun">=</span><span class="pln"> threading</span><span class="pun">.</span><span class="typ">Thread</span><span class="pun">(</span><span class="pln">target</span><span class="pun">=</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">event_queue</span><span class="pun">)</span><span class="pln">
        eq</span><span class="pun">.</span><span class="pln">name </span><span class="pun">=</span><span class="pln"> </span><span class="str">'events'</span><span class="pln">
        eq</span><span class="pun">.</span><span class="pln">start</span><span class="pun">()</span><span class="pln">
        </span><span class="com">#hw = threading.Thread(target=self.host_watch)</span><span class="pln">
        </span><span class="com">#hw.name = 'host_watch'</span><span class="pln">
        </span><span class="com">#hw.start()</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">do_first_run</span><span class="pun">()</span><span class="pln">
        threading</span><span class="pun">.</span><span class="typ">Thread</span><span class="pun">(</span><span class="pln">target</span><span class="pun">=</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">status</span><span class="pun">).</span><span class="pln">start</span><span class="pun">()</span><span class="pln">
        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">main_loop</span><span class="pun">()</span><span class="pln">

     </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 42</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">char</span>, 
				under directory <span style="font-style:italic;">char</span>, 
				in source file <span style="font-style:italic;">mainchar.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 5				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="96659">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="96659">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> main</span><span class="pun">():</span><span class="pln">
    </span><span class="com">###########################</span><span class="pln">
    </span><span class="com">### Command Line Parser ###</span><span class="pln">
    </span><span class="com">###########################</span><span class="pln">
    usage </span><span class="pun">=</span><span class="pln"> </span><span class="str">"usage: %prog [options] confchar"</span><span class="pln">
    parser </span><span class="pun">=</span><span class="pln"> </span><span class="typ">OptionParser</span><span class="pun">(</span><span class="pln">usage</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-v"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--verbose"</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"VERBOSE"</span><span class="pun">,</span><span class="pln"> 
        </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln"> help</span><span class="pun">=</span><span class="str">"Gives extra info while running."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-i"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--input"</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"MAKE_INPUT"</span><span class="pun">,</span><span class="pln"> 
        help</span><span class="pun">=</span><span class="str">"Makes the transport calculation input deck."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-r"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--run"</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"RUN_TRANSPORT"</span><span class="pun">,</span><span class="pln"> 
        </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln"> help</span><span class="pun">=</span><span class="str">"Run the transport calculation."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-d"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--dry-run"</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">"store_false"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"RUN_TRANSPORT"</span><span class="pun">,</span><span class="pln"> 
        help</span><span class="pun">=</span><span class="str">"Dry Run. Do NOT run the transport calculation."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-a"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--analyze"</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"RUN_ANALYSIS"</span><span class="pun">,</span><span class="pln"> 
        </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln"> help</span><span class="pun">=</span><span class="str">"Run analysis on database."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-b"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--burnup"</span><span class="pun">,</span><span class="pln">  action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"RUN_BURNUP"</span><span class="pun">,</span><span class="pln"> 
        </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln"> help</span><span class="pun">=</span><span class="str">"Run the burnup calculation."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-x"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--xs"</span><span class="pun">,</span><span class="pln">  action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"RUN_XS_GEN"</span><span class="pun">,</span><span class="pln"> 
        </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln"> help</span><span class="pun">=</span><span class="str">"Run the cross-section generation calculation."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-m"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--delta-mass"</span><span class="pun">,</span><span class="pln">  action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"RUN_DELTAM"</span><span class="pun">,</span><span class="pln"> 
        </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln"> help</span><span class="pun">=</span><span class="str">"Run the initial nuclide sensitivity calculation."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-N"</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">"store"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"NPERT"</span><span class="pun">,</span><span class="pln"> 
        </span><span class="kwd">default</span><span class="pun">=</span><span class="str">''</span><span class="pun">,</span><span class="pln"> help</span><span class="pun">=</span><span class="str">"Pertubation indices to calculate, in Python slice syntax."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-I"</span><span class="pun">,</span><span class="pln">  action</span><span class="pun">=</span><span class="str">"store"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"ISOS"</span><span class="pun">,</span><span class="pln"> 
        </span><span class="kwd">default</span><span class="pun">=</span><span class="str">''</span><span class="pun">,</span><span class="pln"> help</span><span class="pun">=</span><span class="str">"Nuclides to calculate."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-S"</span><span class="pun">,</span><span class="pln">  action</span><span class="pun">=</span><span class="str">"store"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"NSENS"</span><span class="pun">,</span><span class="pln"> 
        </span><span class="kwd">default</span><span class="pun">=</span><span class="str">''</span><span class="pun">,</span><span class="pln"> help</span><span class="pun">=</span><span class="str">"Sensitivity indices to calculate, in Python slice syntax."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-c"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--clean"</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"CLEAN"</span><span class="pun">,</span><span class="pln"> 
        help</span><span class="pun">=</span><span class="str">"Cleans the reactor direactory of current files."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-C"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--cache"</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"CACHE"</span><span class="pun">,</span><span class="pln"> 
        </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln"> help</span><span class="pun">=</span><span class="str">"Uses the current files in the reactor direactory."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-l"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--local"</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"LOCAL"</span><span class="pun">,</span><span class="pln"> 
        </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">,</span><span class="pln"> help</span><span class="pun">=</span><span class="str">"Run or Fetch files locally."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-s"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--server"</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">"store_false"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"LOCAL"</span><span class="pun">,</span><span class="pln"> 
        help</span><span class="pun">=</span><span class="str">"Run or Fetch files from a remote server."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-f"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--fetch"</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"FETCH_FILES"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln"> 
        help</span><span class="pun">=</span><span class="str">"Fetches files from the remote server. Does not run transport, even if -r is set. Automatically sets -s."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-p"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--pid"</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"PID"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln"> 
        help</span><span class="pun">=</span><span class="str">"Finds the process identification number of a current transport run. Sets -d."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-k"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--kill"</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"KILL_TRANSPORT"</span><span class="pun">,</span><span class="pln"> 
        </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln"> help</span><span class="pun">=</span><span class="str">"Kills the current transport run. Sets -p."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"--cwd"</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"CWD"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln"> 
        help</span><span class="pun">=</span><span class="str">"Run char in the current working directory."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"--ui"</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"UI"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln"> 
        help</span><span class="pun">=</span><span class="str">"Launches the char ui."</span><span class="pun">)</span><span class="pln">

    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-t"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--test"</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">"TEST"</span><span class="pun">,</span><span class="pln"> 
        </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln"> help</span><span class="pun">=</span><span class="str">"Tests an existing library for soundness."</span><span class="pun">)</span><span class="pln">

    </span><span class="pun">(</span><span class="pln">options</span><span class="pun">,</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> parser</span><span class="pun">.</span><span class="pln">parse_args</span><span class="pun">()</span><span class="pln">

    </span><span class="com"># Try launching ui before anything else</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">UI</span><span class="pun">:</span><span class="pln">
        </span><span class="com"># Test to see if ui library is installed</span><span class="pln">
        </span><span class="kwd">try</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">from</span><span class="pln"> </span><span class="pun">.</span><span class="pln">ui </span><span class="kwd">import</span><span class="pln"> app
        </span><span class="kwd">except</span><span class="pln"> </span><span class="typ">ImportError</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">failure</span><span class="pun">(</span><span class="str">"Please install the Enthought Tool Suite (ETS) for CHAR UI."</span><span class="pun">))</span><span class="pln">
            </span><span class="kwd">raise</span><span class="pln"> </span><span class="typ">SystemExit</span><span class="pln">

        </span><span class="com"># Open UI</span><span class="pln">
        application </span><span class="pun">=</span><span class="pln"> app</span><span class="pun">.</span><span class="typ">Application</span><span class="pun">()</span><span class="pln">
        </span><span class="com">#application.rx_h5_path = "/home/scopatz/MultiGroupPaper/DataXS/lwr/lwr.h5"</span><span class="pln">
        application</span><span class="pun">.</span><span class="pln">configure_traits</span><span class="pun">()</span><span class="pln">

        </span><span class="com"># Clean-up UI</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> application</span><span class="pun">.</span><span class="pln">rx_h5 </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">:</span><span class="pln">
            application</span><span class="pun">.</span><span class="pln">rx_h5</span><span class="pun">.</span><span class="pln">close</span><span class="pun">()</span><span class="pln">

        </span><span class="kwd">raise</span><span class="pln"> </span><span class="typ">SystemExit</span><span class="pln">

    </span><span class="com"># Make sure we have a configureation file before proceeding</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">args</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">failure</span><span class="pun">(</span><span class="str">"Please specify a file for char."</span><span class="pun">))</span><span class="pln">
        </span><span class="kwd">raise</span><span class="pln"> </span><span class="typ">SystemExit</span><span class="pln">

    absolute_path </span><span class="pun">=</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">abspath</span><span class="pun">(</span><span class="pln">args</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])</span><span class="pln">

    </span><span class="com"># Run tests on a db file</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">TEST</span><span class="pun">:</span><span class="pln">
        _run_tests</span><span class="pun">(</span><span class="pln">absolute_path</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">raise</span><span class="pln"> </span><span class="typ">SystemExit</span><span class="pln">

    </span><span class="com"># Load the CHAR definition file into its own env namespace</span><span class="pln">
    env </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
    execfile</span><span class="pun">(</span><span class="pln">absolute_path</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{},</span><span class="pln"> env</span><span class="pun">)</span><span class="pln">


    </span><span class="com"># Add command line arguments to env</span><span class="pln">
    env</span><span class="pun">[</span><span class="str">'options'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> options
    env</span><span class="pun">[</span><span class="str">'args'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> args

    </span><span class="com"># Update defchar adding more useful values.</span><span class="pln">
    env </span><span class="pun">=</span><span class="pln"> envchar</span><span class="pun">.</span><span class="pln">update_env</span><span class="pun">(</span><span class="pln">env</span><span class="pun">)</span><span class="pln">

    </span><span class="com">#intial command-line options protocol.</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">KILL_TRANSPORT</span><span class="pun">:</span><span class="pln">
        options</span><span class="pun">.</span><span class="pln">PID </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln">                      </span><span class="com">#Ensures that the PID is found in order that it mak be killed.</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">PID</span><span class="pun">:</span><span class="pln">
        options</span><span class="pun">.</span><span class="pln">RUN_XS_GEN </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
        options</span><span class="pun">.</span><span class="pln">RUN_DELTAM </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
        options</span><span class="pun">.</span><span class="pln">RUN_TRANSPORT </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">            </span><span class="com">#Ensures that transport calculation is not initiated while fetching files.</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">FETCH_FILES</span><span class="pun">:</span><span class="pln">
        options</span><span class="pun">.</span><span class="pln">RUN_XS_GEN </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
        options</span><span class="pun">.</span><span class="pln">RUN_DELTAM </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
        options</span><span class="pun">.</span><span class="pln">RUN_TRANSPORT </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">            </span><span class="com">#Ensures that transport calculation is not initiated while fetching files.</span><span class="pln">
        options</span><span class="pun">.</span><span class="pln">LOCAL </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">                   </span><span class="com">#Ensures that ssh package is loaded.</span><span class="pln">

    </span><span class="com">################</span><span class="pln">
    </span><span class="com">#### Script ####</span><span class="pln">
    </span><span class="com">################</span><span class="pln">

    </span><span class="com"># Prep work</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">CWD</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> env</span><span class="pun">[</span><span class="str">'options'</span><span class="pun">].</span><span class="pln">CLEAN</span><span class="pun">:</span><span class="pln">
            remove</span><span class="pun">(</span><span class="pln">env</span><span class="pun">[</span><span class="str">'reactor'</span><span class="pun">])</span><span class="pln">

        </span><span class="kwd">if</span><span class="pln"> env</span><span class="pun">[</span><span class="str">'reactor'</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">listdir</span><span class="pun">(</span><span class="str">'.'</span><span class="pun">):</span><span class="pln">
            os</span><span class="pun">.</span><span class="pln">mkdir</span><span class="pun">(</span><span class="pln">env</span><span class="pun">[</span><span class="str">'reactor'</span><span class="pun">])</span><span class="pln">

        os</span><span class="pun">.</span><span class="pln">chdir</span><span class="pun">(</span><span class="pln">env</span><span class="pun">[</span><span class="str">'reactor'</span><span class="pun">])</span><span class="pln">
        shutil</span><span class="pun">.</span><span class="pln">copyfile</span><span class="pun">(</span><span class="pln">absolute_path</span><span class="pun">,</span><span class="pln"> </span><span class="str">'defchar.py'</span><span class="pun">)</span><span class="pln">

    </span><span class="com"># Start up logger</span><span class="pln">
    logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">(</span><span class="str">'char'</span><span class="pun">)</span><span class="pln">
    hdlr </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'char.log'</span><span class="pun">)</span><span class="pln">
    formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'%(asctime)s %(levelname)s %(message)s'</span><span class="pun">)</span><span class="pln">
    hdlr</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
    logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">hdlr</span><span class="pun">)</span><span class="pln">
    logger</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">)</span><span class="pln">
    env</span><span class="pun">[</span><span class="str">'logger'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> logger

    </span><span class="com"># Set the neutronics code</span><span class="pln">
    n_coder </span><span class="pun">=</span><span class="pln"> n_code_switch</span><span class="pun">[</span><span class="pln">env</span><span class="pun">[</span><span class="str">'transporter'</span><span class="pun">]]</span><span class="pln">
    n_code </span><span class="pun">=</span><span class="pln"> n_coder</span><span class="pun">(</span><span class="pln">env</span><span class="pun">)</span><span class="pln">
    env</span><span class="pun">[</span><span class="str">'n_code'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> n_code

    </span><span class="com"># Get the run controller</span><span class="pln">
    runner </span><span class="pun">=</span><span class="pln"> run_switch</span><span class="pun">[</span><span class="pln">env</span><span class="pun">[</span><span class="str">'scheduler'</span><span class="pun">]]</span><span class="pln">
    runchar </span><span class="pun">=</span><span class="pln"> runner</span><span class="pun">(</span><span class="pln">n_code</span><span class="pun">,</span><span class="pln"> env</span><span class="pun">)</span><span class="pln">

    </span><span class="com"># Get the inputs indeces</span><span class="pln">
    idx </span><span class="pun">=</span><span class="pln"> parse_slice</span><span class="pun">(</span><span class="pln">options</span><span class="pun">.</span><span class="pln">NPERT</span><span class="pun">,</span><span class="pln"> n_code</span><span class="pun">.</span><span class="pln">nperturbations</span><span class="pun">)</span><span class="pln">

    nucs </span><span class="pun">=</span><span class="pln"> parse_nucs</span><span class="pun">(</span><span class="pln">options</span><span class="pun">.</span><span class="pln">ISOS</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">nucs</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
        nucs </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">set</span><span class="pun">(</span><span class="pln">env</span><span class="pun">[</span><span class="str">'core_transmute'</span><span class="pun">])</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        nucs </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">nucs </span><span class="pun">&amp;</span><span class="pln"> </span><span class="kwd">set</span><span class="pun">(</span><span class="pln">env</span><span class="pun">[</span><span class="str">'core_transmute'</span><span class="pun">]))</span><span class="pln">
    ihm_nucs </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">nucs </span><span class="pun">&amp;</span><span class="pln"> </span><span class="kwd">set</span><span class="pun">(</span><span class="pln">env</span><span class="pun">[</span><span class="str">'ihm_mat'</span><span class="pun">].</span><span class="pln">comp</span><span class="pun">.</span><span class="pln">keys</span><span class="pun">()))</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> </span><span class="str">'deltam'</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> env</span><span class="pun">:</span><span class="pln">
        sidx </span><span class="pun">=</span><span class="pln"> parse_slice</span><span class="pun">(</span><span class="pln">options</span><span class="pun">.</span><span class="pln">NSENS</span><span class="pun">,</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">env</span><span class="pun">[</span><span class="str">'deltam'</span><span class="pun">]))</span><span class="pln">

    </span><span class="com"># Make the input file unless otherwise specified.</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">options</span><span class="pun">.</span><span class="pln">MAKE_INPUT</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">not</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">FETCH_FILES</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">not</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">PID</span><span class="pun">):</span><span class="pln">
        runchar</span><span class="pun">.</span><span class="pln">init_h5</span><span class="pun">()</span><span class="pln">

    </span><span class="com"># Check a bunch of run conditions</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">RUN_TRANSPORT</span><span class="pun">:</span><span class="pln">
        </span><span class="com"># Run Transport code</span><span class="pln">
        runchar</span><span class="pun">.</span><span class="pln">make_run_script</span><span class="pun">()</span><span class="pln">

        </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">LOCAL</span><span class="pun">:</span><span class="pln">
            runchar</span><span class="pun">.</span><span class="pln">run_locally</span><span class="pun">()</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            runchar</span><span class="pun">.</span><span class="pln">run_remotely</span><span class="pun">()</span><span class="pln">

    </span><span class="kwd">elif</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">RUN_ANALYSIS</span><span class="pun">:</span><span class="pln">
        n_code</span><span class="pun">.</span><span class="pln">analyze_deltam</span><span class="pun">()</span><span class="pln">

    </span><span class="kwd">elif</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">RUN_BURNUP </span><span class="kwd">or</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">RUN_XS_GEN </span><span class="kwd">or</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">RUN_DELTAM</span><span class="pun">:</span><span class="pln">
        </span><span class="com"># Make tranumatrion libraries by executing the as a separate step from </span><span class="pln">
        </span><span class="com"># the cross-section generation</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">RUN_BURNUP</span><span class="pun">:</span><span class="pln">
            runchar</span><span class="pun">.</span><span class="pln">burnup</span><span class="pun">(</span><span class="pln">idx</span><span class="pun">)</span><span class="pln">

        </span><span class="com"># Make Cross-sections as a separate step from the burnup calculation</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">RUN_XS_GEN</span><span class="pun">:</span><span class="pln">
            runchar</span><span class="pun">.</span><span class="pln">xs_gen</span><span class="pun">(</span><span class="pln">idx</span><span class="pun">,</span><span class="pln"> nucs</span><span class="pun">)</span><span class="pln">

        </span><span class="com"># Run initial nuclide sensitivity calculation</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">RUN_DELTAM</span><span class="pun">:</span><span class="pln">
            n_code</span><span class="pun">.</span><span class="pln">run_deltam_pert</span><span class="pun">(</span><span class="pln">idx</span><span class="pun">,</span><span class="pln"> ihm_isos</span><span class="pun">,</span><span class="pln"> sidx</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">elif</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">FETCH_FILES</span><span class="pun">:</span><span class="pln">
        </span><span class="com"># Fetches files from remote server</span><span class="pln">
        runchar</span><span class="pun">.</span><span class="pln">fetch</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">PID</span><span class="pun">:</span><span class="pln">
        </span><span class="com"># Finds and prints the PID of CHAR</span><span class="pln">
        runchar</span><span class="pun">.</span><span class="pln">pid</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">KILL_TRANSPORT</span><span class="pun">:</span><span class="pln">
        </span><span class="com"># Finds and kills CHAR</span><span class="pln">
        runchar</span><span class="pun">.</span><span class="pln">kill</span><span class="pun">()</span><span class="pln">

    </span><span class="com"># Clean up</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">CWD</span><span class="pun">:</span><span class="pln">
        os</span><span class="pun">.</span><span class="pln">chdir</span><span class="pun">(</span><span class="str">'..'</span><span class="pun">)</span><span class="pln">


</span><span class="com"># Run CHAR</span><span class="pln">
 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 43</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">cobbler</span>, 
				under directory <span style="font-style:italic;">scripts</span>, 
				in source file <span style="font-style:italic;">tftpd.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 5				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="101635">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="101635">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> main</span><span class="pun">():</span><span class="pln">
    </span><span class="com"># If we're called from xinetd, set idle to non-zero</span><span class="pln">
    mode </span><span class="pun">=</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">fstat</span><span class="pun">(</span><span class="pln">sys</span><span class="pun">.</span><span class="pln">stdin</span><span class="pun">.</span><span class="pln">fileno</span><span class="pun">()).</span><span class="pln">st_mode
    </span><span class="kwd">if</span><span class="pln"> stat</span><span class="pun">.</span><span class="pln">S_ISSOCK</span><span class="pun">(</span><span class="pln">mode</span><span class="pun">):</span><span class="pln">
        OPTIONS</span><span class="pun">[</span><span class="str">"idle"</span><span class="pun">]</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="lit">30</span><span class="pln">
        OPTIONS</span><span class="pun">[</span><span class="str">"logger"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"syslog"</span><span class="pln">

    </span><span class="com"># setup option parsing</span><span class="pln">
    opt_help </span><span class="pun">=</span><span class="pln"> dict</span><span class="pun">(</span><span class="pln">
        port   </span><span class="pun">=</span><span class="pln"> dict</span><span class="pun">(</span><span class="pln">type</span><span class="pun">=</span><span class="str">"int"</span><span class="pun">,</span><span class="pln">help</span><span class="pun">=</span><span class="str">"The port to bind to for new requests"</span><span class="pun">),</span><span class="pln">
        idle   </span><span class="pun">=</span><span class="pln"> dict</span><span class="pun">(</span><span class="pln">type</span><span class="pun">=</span><span class="str">"int"</span><span class="pun">,</span><span class="pln">help</span><span class="pun">=</span><span class="str">"How long to wait for input"</span><span class="pun">),</span><span class="pln">
        timeout</span><span class="pun">=</span><span class="pln"> dict</span><span class="pun">(</span><span class="pln">type</span><span class="pun">=</span><span class="str">"int"</span><span class="pun">,</span><span class="pln">help</span><span class="pun">=</span><span class="str">"How long to wait for a given request"</span><span class="pun">),</span><span class="pln">
        max_blksize</span><span class="pun">=</span><span class="pln">dict</span><span class="pun">(</span><span class="pln">type</span><span class="pun">=</span><span class="str">"int"</span><span class="pun">,</span><span class="pln"> help</span><span class="pun">=</span><span class="str">"The maximum block size to permit"</span><span class="pln"> </span><span class="pun">),</span><span class="pln">
        prefix </span><span class="pun">=</span><span class="pln"> dict</span><span class="pun">(</span><span class="pln">type</span><span class="pun">=</span><span class="str">"string"</span><span class="pun">,</span><span class="pln">
                      help</span><span class="pun">=</span><span class="str">"Where files are stored by default ["</span><span class="pln">
                                                       </span><span class="pun">+</span><span class="pln">OPTIONS</span><span class="pun">[</span><span class="str">"prefix"</span><span class="pun">]+</span><span class="str">"]"</span><span class="pun">),</span><span class="pln">
        logger </span><span class="pun">=</span><span class="pln"> dict</span><span class="pun">(</span><span class="pln">type</span><span class="pun">=</span><span class="str">"string"</span><span class="pun">,</span><span class="pln">help</span><span class="pun">=</span><span class="str">"How to log"</span><span class="pun">),</span><span class="pln">
        file_cmd</span><span class="pun">=</span><span class="pln"> dict</span><span class="pun">(</span><span class="pln">type</span><span class="pun">=</span><span class="str">"string"</span><span class="pun">,</span><span class="pln">help</span><span class="pun">=</span><span class="str">"The location of the 'file' command"</span><span class="pun">),</span><span class="pln">
        user  </span><span class="pun">=</span><span class="pln"> dict</span><span class="pun">(</span><span class="pln">type</span><span class="pun">=</span><span class="str">"string"</span><span class="pun">,</span><span class="pln">help</span><span class="pun">=</span><span class="str">"The user to run as [nobody]"</span><span class="pun">),</span><span class="pln">
    </span><span class="pun">)</span><span class="pln">

    parser </span><span class="pun">=</span><span class="pln"> optparse</span><span class="pun">.</span><span class="typ">OptionParser</span><span class="pun">(</span><span class="pln">
        formatter</span><span class="pun">=</span><span class="pln">optparse</span><span class="pun">.</span><span class="typ">IndentedHelpFormatter</span><span class="pun">(),</span><span class="pln">
        usage</span><span class="pun">=</span><span class="pln">globals</span><span class="pun">()[</span><span class="str">'__doc__'</span><span class="pun">],</span><span class="pln">
        version</span><span class="pun">=</span><span class="pln">VERSION</span><span class="pun">)</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">'-v'</span><span class="pun">,</span><span class="str">'--verbose'</span><span class="pun">,</span><span class="pln">action</span><span class="pun">=</span><span class="str">'store_true'</span><span class="pun">,</span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln">
                        help</span><span class="pun">=</span><span class="str">"Increase output verbosity"</span><span class="pun">)</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">'-d'</span><span class="pun">,</span><span class="str">'--debug'</span><span class="pun">,</span><span class="pln">action</span><span class="pun">=</span><span class="str">'store_true'</span><span class="pun">,</span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln">
                        help</span><span class="pun">=</span><span class="str">"Debug (vastly increases output verbosity)"</span><span class="pun">)</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">'-c'</span><span class="pun">,</span><span class="str">'--cache'</span><span class="pun">,</span><span class="pln">action</span><span class="pun">=</span><span class="str">'store_true'</span><span class="pun">,</span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">,</span><span class="pln">
                        help</span><span class="pun">=</span><span class="str">"Use a cache to help find hosts w/o IP address"</span><span class="pun">)</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">'--cache-time'</span><span class="pun">,</span><span class="pln">action</span><span class="pun">=</span><span class="str">'store'</span><span class="pun">,</span><span class="pln">type</span><span class="pun">=</span><span class="str">"int"</span><span class="pun">,</span><span class="kwd">default</span><span class="pun">=</span><span class="lit">5</span><span class="pun">*</span><span class="lit">60</span><span class="pun">,</span><span class="pln">
                        help</span><span class="pun">=</span><span class="str">"How long an ip-&gt;name mapping is valid"</span><span class="pun">)</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">'--neg-cache-time'</span><span class="pun">,</span><span class="pln">action</span><span class="pun">=</span><span class="str">'store'</span><span class="pun">,</span><span class="pln">type</span><span class="pun">=</span><span class="str">"int"</span><span class="pun">,</span><span class="kwd">default</span><span class="pun">=</span><span class="lit">10</span><span class="pun">,</span><span class="pln">
                        help</span><span class="pun">=</span><span class="str">"How long an ip-&gt;name mapping is valid"</span><span class="pun">)</span><span class="pln">

    opts </span><span class="pun">=</span><span class="pln"> opt_help</span><span class="pun">.</span><span class="pln">keys</span><span class="pun">()</span><span class="pln">
    opts</span><span class="pun">.</span><span class="pln">sort</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> k </span><span class="kwd">in</span><span class="pln"> opts</span><span class="pun">:</span><span class="pln">
        v </span><span class="pun">=</span><span class="pln"> opt_help</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]</span><span class="pln">
        parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"--"</span><span class="pun">+</span><span class="pln">k</span><span class="pun">,</span><span class="kwd">default</span><span class="pun">=</span><span class="pln">OPTIONS</span><span class="pun">[</span><span class="pln">k</span><span class="pun">],</span><span class="pln">
                            type</span><span class="pun">=</span><span class="pln">v</span><span class="pun">[</span><span class="str">"type"</span><span class="pun">],</span><span class="pln">help</span><span class="pun">=</span><span class="pln">v</span><span class="pun">[</span><span class="str">"help"</span><span class="pun">])</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">'-B'</span><span class="pun">,</span><span class="pln">dest</span><span class="pun">=</span><span class="str">"max_blksize"</span><span class="pun">,</span><span class="pln">type</span><span class="pun">=</span><span class="str">"int"</span><span class="pun">,</span><span class="kwd">default</span><span class="pun">=</span><span class="lit">1428</span><span class="pun">,</span><span class="pln">
                        help</span><span class="pun">=</span><span class="str">"alias for --max-blksize, for in.tftpd compatibility"</span><span class="pun">)</span><span class="pln">

    </span><span class="com"># Actually read the args</span><span class="pln">
    </span><span class="pun">(</span><span class="pln">options</span><span class="pun">,</span><span class="pln">args</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> parser</span><span class="pun">.</span><span class="pln">parse_args</span><span class="pun">()</span><span class="pln">

    </span><span class="kwd">for</span><span class="pln"> attr </span><span class="kwd">in</span><span class="pln"> dir</span><span class="pun">(</span><span class="pln">options</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> attr </span><span class="kwd">in</span><span class="pln"> OPTIONS</span><span class="pun">:</span><span class="pln">
            OPTIONS</span><span class="pun">[</span><span class="pln">attr</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> getattr</span><span class="pun">(</span><span class="pln">options</span><span class="pun">,</span><span class="pln">attr</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> stat</span><span class="pun">.</span><span class="pln">S_ISSOCK</span><span class="pun">(</span><span class="pln">mode</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">or</span><span class="pln"> OPTIONS</span><span class="pun">[</span><span class="str">"logger"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">"syslog"</span><span class="pun">:</span><span class="pln">
        </span><span class="com"># log to syslog.  Facility 11 isn't in the class, but it's FTP on linux</span><span class="pln">
        logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">handlers</span><span class="pun">.</span><span class="typ">SysLogHandler</span><span class="pun">(</span><span class="str">"/dev/log"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">11</span><span class="pun">)</span><span class="pln"> 
        logger</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">
            logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'%(filename)s: %(levelname)s: %(message)s'</span><span class="pun">))</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> OPTIONS</span><span class="pun">[</span><span class="str">"logger"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">"stream"</span><span class="pun">:</span><span class="pln">
        </span><span class="com"># log to stdout</span><span class="pln">
        logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">StreamHandler</span><span class="pun">()</span><span class="pln">
        logger</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">BASIC_FORMAT</span><span class="pun">))</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">"/var/log/tftpd"</span><span class="pun">)</span><span class="pln">
        logger</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="pln">
            </span><span class="str">"%(asctime)s %(name)s: %(levelname)s: %(message)s"</span><span class="pun">))</span><span class="pln">

    logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">().</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">logger</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> OPTIONS</span><span class="pun">[</span><span class="str">"debug"</span><span class="pun">]:</span><span class="pln">
        logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">().</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> OPTIONS</span><span class="pun">[</span><span class="str">"verbose"</span><span class="pun">]:</span><span class="pln">
        logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">().</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">INFO</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">().</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">WARN</span><span class="pun">)</span><span class="pln">
  
    </span><span class="kwd">if</span><span class="pln"> stat</span><span class="pun">.</span><span class="pln">S_ISSOCK</span><span class="pun">(</span><span class="pln">mode</span><span class="pun">):</span><span class="pln">
        OPTIONS</span><span class="pun">[</span><span class="str">"sock"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> socket</span><span class="pun">.</span><span class="pln">fromfd</span><span class="pun">(</span><span class="pln">sys</span><span class="pun">.</span><span class="pln">stdin</span><span class="pun">.</span><span class="pln">fileno</span><span class="pun">(),</span><span class="pln">
                             socket</span><span class="pun">.</span><span class="pln">AF_INET</span><span class="pun">,</span><span class="pln">
                             socket</span><span class="pun">.</span><span class="pln">SOCK_DGRAM</span><span class="pun">,</span><span class="pln">
                             </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        OPTIONS</span><span class="pun">[</span><span class="str">"sock"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> socket</span><span class="pun">.</span><span class="pln">socket</span><span class="pun">(</span><span class="pln">socket</span><span class="pun">.</span><span class="pln">AF_INET</span><span class="pun">,</span><span class="pln">socket</span><span class="pun">.</span><span class="pln">SOCK_DGRAM</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
        OPTIONS</span><span class="pun">[</span><span class="str">"sock"</span><span class="pun">].</span><span class="pln">setsockopt</span><span class="pun">(</span><span class="pln">socket</span><span class="pun">.</span><span class="pln">SOL_SOCKET</span><span class="pun">,</span><span class="pln"> socket</span><span class="pun">.</span><span class="pln">SO_REUSEADDR</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">try</span><span class="pun">:</span><span class="pln">
            OPTIONS</span><span class="pun">[</span><span class="str">"sock"</span><span class="pun">].</span><span class="pln">bind</span><span class="pun">((</span><span class="str">""</span><span class="pun">,</span><span class="pln">OPTIONS</span><span class="pun">[</span><span class="str">"port"</span><span class="pun">]))</span><span class="pln">
        </span><span class="kwd">except</span><span class="pln"> socket</span><span class="pun">.</span><span class="pln">error</span><span class="pun">,</span><span class="pln"> e</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> e</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">(</span><span class="pln">errno</span><span class="pun">.</span><span class="pln">EPERM</span><span class="pun">,</span><span class="pln"> errno</span><span class="pun">.</span><span class="pln">EACCES</span><span class="pun">):</span><span class="pln">
                </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"Unable to bind to port %d"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> OPTIONS</span><span class="pun">[</span><span class="str">"port"</span><span class="pun">]</span><span class="pln">
                </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln">
            </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
                </span><span class="kwd">raise</span><span class="pln">

    OPTIONS</span><span class="pun">[</span><span class="str">"sock"</span><span class="pun">].</span><span class="pln">setblocking</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">getuid</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
        uid </span><span class="pun">=</span><span class="pln"> pwd</span><span class="pun">.</span><span class="pln">getpwnam</span><span class="pun">(</span><span class="pln">OPTIONS</span><span class="pun">[</span><span class="str">"user"</span><span class="pun">])[</span><span class="lit">2</span><span class="pun">]</span><span class="pln">
        os</span><span class="pun">.</span><span class="pln">setreuid</span><span class="pun">(</span><span class="pln">uid</span><span class="pun">,</span><span class="pln">uid</span><span class="pun">)</span><span class="pln">

    </span><span class="com"># This takes a while, so do it after we open the port, so we</span><span class="pln">
    </span><span class="com"># don't drop the packet that spawned us</span><span class="pln">
    templar </span><span class="pun">=</span><span class="pln"> cobbler</span><span class="pun">.</span><span class="pln">templar</span><span class="pun">.</span><span class="typ">Templar</span><span class="pun">(</span><span class="kwd">None</span><span class="pun">)</span><span class="pln">

    io_loop </span><span class="pun">=</span><span class="pln"> ioloop</span><span class="pun">.</span><span class="typ">IOLoop</span><span class="pun">.</span><span class="pln">instance</span><span class="pun">()</span><span class="pln">
    io_loop</span><span class="pun">.</span><span class="pln">add_handler</span><span class="pun">(</span><span class="pln">OPTIONS</span><span class="pun">[</span><span class="str">"sock"</span><span class="pun">].</span><span class="pln">fileno</span><span class="pun">(),</span><span class="pln">
                        </span><span class="kwd">partial</span><span class="pun">(</span><span class="pln">new_req</span><span class="pun">,</span><span class="pln">OPTIONS</span><span class="pun">[</span><span class="str">"sock"</span><span class="pun">],</span><span class="pln">templar</span><span class="pun">),</span><span class="pln">io_loop</span><span class="pun">.</span><span class="pln">READ</span><span class="pun">)</span><span class="pln">
    </span><span class="com"># Shove the timeout into OPTIONS, because it's there</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> OPTIONS</span><span class="pun">[</span><span class="str">"idle"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
        OPTIONS</span><span class="pun">[</span><span class="str">"idle_timer"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> io_loop</span><span class="pun">.</span><span class="pln">add_timeout</span><span class="pun">(</span><span class="pln">time</span><span class="pun">.</span><span class="pln">time</span><span class="pun">()+</span><span class="pln">OPTIONS</span><span class="pun">[</span><span class="str">"idle"</span><span class="pun">],</span><span class="pln">
                                                    </span><span class="kwd">lambda</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> idle_out</span><span class="pun">())</span><span class="pln">

    logging</span><span class="pun">.</span><span class="pln">info</span><span class="pun">(</span><span class="str">'Starting Eventloop'</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">try</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">try</span><span class="pun">:</span><span class="pln">
            io_loop</span><span class="pun">.</span><span class="pln">start</span><span class="pun">()</span><span class="pln">
        </span><span class="kwd">except</span><span class="pln"> </span><span class="typ">KeyboardInterrupt</span><span class="pun">:</span><span class="pln">
            </span><span class="com"># Someone hit ^C</span><span class="pln">
            logging</span><span class="pun">.</span><span class="pln">info</span><span class="pun">(</span><span class="str">'Exiting'</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">finally</span><span class="pun">:</span><span class="pln">
        OPTIONS</span><span class="pun">[</span><span class="str">"sock"</span><span class="pun">].</span><span class="pln">close</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    
 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 44</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">laikaboss-master</span>, 
				under directory <span style="font-style:italic;"></span>, 
				in source file <span style="font-style:italic;">laika.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 5				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="133562">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="133562">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> main</span><span class="pun">():</span><span class="pln">
    </span><span class="com"># Define default configuration location</span><span class="pln">

    parser </span><span class="pun">=</span><span class="pln"> </span><span class="typ">OptionParser</span><span class="pun">(</span><span class="pln">usage</span><span class="pun">=</span><span class="str">"usage: %prog [options] /path/to/file"</span><span class="pun">)</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-d"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--debug"</span><span class="pun">,</span><span class="pln">
                      action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln">
                      dest</span><span class="pun">=</span><span class="str">"debug"</span><span class="pun">,</span><span class="pln">
                      help</span><span class="pun">=</span><span class="str">"enable debug messages to the console."</span><span class="pun">)</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-c"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--config-path"</span><span class="pun">,</span><span class="pln">
                      action</span><span class="pun">=</span><span class="str">"store"</span><span class="pun">,</span><span class="pln"> type</span><span class="pun">=</span><span class="str">"string"</span><span class="pun">,</span><span class="pln">
                      dest</span><span class="pun">=</span><span class="str">"config_path"</span><span class="pun">,</span><span class="pln">
                      help</span><span class="pun">=</span><span class="str">"path to configuration for laikaboss framework."</span><span class="pun">)</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-o"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--out-path"</span><span class="pun">,</span><span class="pln">
                      action</span><span class="pun">=</span><span class="str">"store"</span><span class="pun">,</span><span class="pln"> type</span><span class="pun">=</span><span class="str">"string"</span><span class="pun">,</span><span class="pln">
                      dest</span><span class="pun">=</span><span class="str">"save_path"</span><span class="pun">,</span><span class="pln">
                      help</span><span class="pun">=</span><span class="str">"Write all results to the specified path"</span><span class="pun">)</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-s"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--source"</span><span class="pun">,</span><span class="pln">
                      action</span><span class="pun">=</span><span class="str">"store"</span><span class="pun">,</span><span class="pln"> type</span><span class="pun">=</span><span class="str">"string"</span><span class="pun">,</span><span class="pln">
                      dest</span><span class="pun">=</span><span class="str">"source"</span><span class="pun">,</span><span class="pln">
                      help</span><span class="pun">=</span><span class="str">"Set the source (may affect dispatching) [default:laika]"</span><span class="pun">)</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-p"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--num_procs"</span><span class="pun">,</span><span class="pln">
                      action</span><span class="pun">=</span><span class="str">"store"</span><span class="pun">,</span><span class="pln"> type</span><span class="pun">=</span><span class="str">"int"</span><span class="pun">,</span><span class="pln">
                      dest</span><span class="pun">=</span><span class="str">"num_procs"</span><span class="pun">,</span><span class="pln">
                      </span><span class="kwd">default</span><span class="pun">=</span><span class="lit">8</span><span class="pun">,</span><span class="pln">
                      help</span><span class="pun">=</span><span class="str">"Specify the number of CPU's to use for a recursive scan. [default:8]"</span><span class="pun">)</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-l"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--log"</span><span class="pun">,</span><span class="pln">
                      action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln">
                      dest</span><span class="pun">=</span><span class="str">"log_result"</span><span class="pun">,</span><span class="pln">
                      help</span><span class="pun">=</span><span class="str">"enable logging to syslog"</span><span class="pun">)</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-m"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--module"</span><span class="pun">,</span><span class="pln">
                      action</span><span class="pun">=</span><span class="str">"store"</span><span class="pun">,</span><span class="pln"> type</span><span class="pun">=</span><span class="str">"string"</span><span class="pun">,</span><span class="pln">
                      dest</span><span class="pun">=</span><span class="str">"scan_modules"</span><span class="pun">,</span><span class="pln">
                      help</span><span class="pun">=</span><span class="str">"Specify individual module(s) to run and their arguments. If multiple, must be a space-separated list."</span><span class="pun">)</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"--parent"</span><span class="pun">,</span><span class="pln">
                      action</span><span class="pun">=</span><span class="str">"store"</span><span class="pun">,</span><span class="pln"> type</span><span class="pun">=</span><span class="str">"string"</span><span class="pun">,</span><span class="pln">
                      dest</span><span class="pun">=</span><span class="str">"parent"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">default</span><span class="pun">=</span><span class="str">""</span><span class="pun">,</span><span class="pln">
                      help</span><span class="pun">=</span><span class="str">"Define the parent of the root object"</span><span class="pun">)</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"-e"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"--ephID"</span><span class="pun">,</span><span class="pln">
                      action</span><span class="pun">=</span><span class="str">"store"</span><span class="pun">,</span><span class="pln"> type</span><span class="pun">=</span><span class="str">"string"</span><span class="pun">,</span><span class="pln">
                      dest</span><span class="pun">=</span><span class="str">"ephID"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">default</span><span class="pun">=</span><span class="str">""</span><span class="pun">,</span><span class="pln">
                      help</span><span class="pun">=</span><span class="str">"Specify an ephemeralID to send with the object"</span><span class="pun">)</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"--metadata"</span><span class="pun">,</span><span class="pln">
                      action</span><span class="pun">=</span><span class="str">"store"</span><span class="pun">,</span><span class="pln">
                      dest</span><span class="pun">=</span><span class="str">"ext_metadata"</span><span class="pun">,</span><span class="pln">
                      help</span><span class="pun">=</span><span class="str">"Define metadata to add to the scan or specify a file containing the metadata."</span><span class="pun">)</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"--size-limit"</span><span class="pun">,</span><span class="pln">
                      action</span><span class="pun">=</span><span class="str">"store"</span><span class="pun">,</span><span class="pln"> type</span><span class="pun">=</span><span class="str">"int"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">default</span><span class="pun">=</span><span class="lit">10</span><span class="pun">,</span><span class="pln">
                      dest</span><span class="pun">=</span><span class="str">"sizeLimit"</span><span class="pun">,</span><span class="pln">
                      help</span><span class="pun">=</span><span class="str">"Specify a size limit in MB (default: 10)"</span><span class="pun">)</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"--file-limit"</span><span class="pun">,</span><span class="pln">
                      action</span><span class="pun">=</span><span class="str">"store"</span><span class="pun">,</span><span class="pln"> type</span><span class="pun">=</span><span class="str">"int"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">default</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">
                      dest</span><span class="pun">=</span><span class="str">"fileLimit"</span><span class="pun">,</span><span class="pln">
                      help</span><span class="pun">=</span><span class="str">"Specify a limited number of files to scan (default: off)"</span><span class="pun">)</span><span class="pln">
    parser</span><span class="pun">.</span><span class="pln">add_option</span><span class="pun">(</span><span class="str">"--no-progress"</span><span class="pun">,</span><span class="pln">
                      action</span><span class="pun">=</span><span class="str">"store_true"</span><span class="pun">,</span><span class="pln">
                      dest</span><span class="pun">=</span><span class="str">"no_progress"</span><span class="pun">,</span><span class="pln">
                      help</span><span class="pun">=</span><span class="str">"disable the progress bar"</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">(</span><span class="pln">options</span><span class="pun">,</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> parser</span><span class="pun">.</span><span class="pln">parse_args</span><span class="pun">()</span><span class="pln">
    
    logger </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">getLogger</span><span class="pun">()</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">debug</span><span class="pun">:</span><span class="pln">
        </span><span class="com"># stdout is added by default, we'll capture this object here</span><span class="pln">
        </span><span class="com">#lhStdout = logger.handlers[0]</span><span class="pln">
        fileHandler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'laika-debug.log'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'w'</span><span class="pun">)</span><span class="pln">
        formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="str">'%(asctime)s %(levelname)s %(message)s'</span><span class="pun">)</span><span class="pln">
        fileHandler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">formatter</span><span class="pun">)</span><span class="pln">
        logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">fileHandler</span><span class="pun">)</span><span class="pln">
        </span><span class="com"># remove stdout from handlers so that debug info is only written to the file</span><span class="pln">
        </span><span class="com">#logger.removeHandler(lhStdout)</span><span class="pln">
        logging</span><span class="pun">.</span><span class="pln">basicConfig</span><span class="pun">(</span><span class="pln">level</span><span class="pun">=</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">
        logger</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">logging</span><span class="pun">.</span><span class="pln">DEBUG</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">global</span><span class="pln"> EXT_METADATA
    </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">ext_metadata</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">exists</span><span class="pun">(</span><span class="pln">options</span><span class="pun">.</span><span class="pln">ext_metadata</span><span class="pun">):</span><span class="pln">
            </span><span class="kwd">with</span><span class="pln"> open</span><span class="pun">(</span><span class="pln">options</span><span class="pun">.</span><span class="pln">ext_metadata</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> metafile</span><span class="pun">:</span><span class="pln">
                EXT_METADATA </span><span class="pun">=</span><span class="pln"> json</span><span class="pun">.</span><span class="pln">loads</span><span class="pun">(</span><span class="pln">metafile</span><span class="pun">.</span><span class="pln">read</span><span class="pun">())</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            EXT_METADATA </span><span class="pun">=</span><span class="pln"> json</span><span class="pun">.</span><span class="pln">loads</span><span class="pun">(</span><span class="pln">options</span><span class="pun">.</span><span class="pln">ext_metadata</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        EXT_METADATA </span><span class="pun">=</span><span class="pln"> getConfig</span><span class="pun">(</span><span class="str">"ext_metadata"</span><span class="pun">)</span><span class="pln">
    
    </span><span class="kwd">global</span><span class="pln"> EPHID
    </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">ephID</span><span class="pun">:</span><span class="pln">
        EPHID </span><span class="pun">=</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">ephID
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        EPHID </span><span class="pun">=</span><span class="pln"> getConfig</span><span class="pun">(</span><span class="str">"ephID"</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">global</span><span class="pln"> SCAN_MODULES
    </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">scan_modules</span><span class="pun">:</span><span class="pln">
        SCAN_MODULES </span><span class="pun">=</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">scan_modules</span><span class="pun">.</span><span class="pln">split</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        SCAN_MODULES </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">None</span><span class="pln">
    logging</span><span class="pun">.</span><span class="pln">debug</span><span class="pun">(</span><span class="str">"SCAN_MODULES: %s"</span><span class="pln">  </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">SCAN_MODULES</span><span class="pun">))</span><span class="pln">

    </span><span class="kwd">global</span><span class="pln"> PROGRESS_BAR
    </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">no_progress</span><span class="pun">:</span><span class="pln">
        PROGRESS_BAR </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        PROGRESS_BAR </span><span class="pun">=</span><span class="pln"> strtobool</span><span class="pun">(</span><span class="pln">getConfig</span><span class="pun">(</span><span class="str">'progress_bar'</span><span class="pun">))</span><span class="pln">
    logging</span><span class="pun">.</span><span class="pln">debug</span><span class="pun">(</span><span class="str">"PROGRESS_BAR: %s"</span><span class="pln">  </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">PROGRESS_BAR</span><span class="pun">))</span><span class="pln">

    </span><span class="kwd">global</span><span class="pln"> LOG_RESULT
    </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">log_result</span><span class="pun">:</span><span class="pln">
        LOG_RESULT </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        LOG_RESULT </span><span class="pun">=</span><span class="pln"> strtobool</span><span class="pun">(</span><span class="pln">getConfig</span><span class="pun">(</span><span class="str">'log_result'</span><span class="pun">))</span><span class="pln">
    logging</span><span class="pun">.</span><span class="pln">debug</span><span class="pun">(</span><span class="str">"LOG_RESULT: %s"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">LOG_RESULT</span><span class="pun">))</span><span class="pln">

    </span><span class="kwd">global</span><span class="pln"> NUM_PROCS
    </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">num_procs</span><span class="pun">:</span><span class="pln">
        NUM_PROCS </span><span class="pun">=</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">num_procs
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        NUM_PROCS </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">getConfig</span><span class="pun">(</span><span class="str">'num_procs'</span><span class="pun">))</span><span class="pln">
    logging</span><span class="pun">.</span><span class="pln">debug</span><span class="pun">(</span><span class="str">"NUM_PROCS: %s"</span><span class="pln">  </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">NUM_PROCS</span><span class="pun">))</span><span class="pln">

    </span><span class="kwd">global</span><span class="pln"> MAX_BYTES
    </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">sizeLimit</span><span class="pun">:</span><span class="pln">
        MAX_BYTES </span><span class="pun">=</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">sizeLimit </span><span class="pun">*</span><span class="pln"> </span><span class="lit">1024</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">1024</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        MAX_BYTES </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">getConfig</span><span class="pun">(</span><span class="str">'max_bytes'</span><span class="pun">))</span><span class="pln">
    logging</span><span class="pun">.</span><span class="pln">debug</span><span class="pun">(</span><span class="str">"MAX_BYTES: %s"</span><span class="pln">  </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">MAX_BYTES</span><span class="pun">))</span><span class="pln">

    </span><span class="kwd">global</span><span class="pln"> MAX_FILES
    </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">fileLimit</span><span class="pun">:</span><span class="pln">
        MAX_FILES </span><span class="pun">=</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">fileLimit
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        MAX_FILES </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">getConfig</span><span class="pun">(</span><span class="str">'max_files'</span><span class="pun">))</span><span class="pln">
    logging</span><span class="pun">.</span><span class="pln">debug</span><span class="pun">(</span><span class="str">"MAX_FILES: %s"</span><span class="pln">  </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">MAX_FILES</span><span class="pun">))</span><span class="pln">

    </span><span class="kwd">global</span><span class="pln"> SOURCE
    </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">source</span><span class="pun">:</span><span class="pln">
        SOURCE </span><span class="pun">=</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">source
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        SOURCE </span><span class="pun">=</span><span class="pln"> getConfig</span><span class="pun">(</span><span class="str">'source'</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">global</span><span class="pln"> SAVE_PATH
    </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">save_path</span><span class="pun">:</span><span class="pln">
        SAVE_PATH </span><span class="pun">=</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">save_path
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        SAVE_PATH </span><span class="pun">=</span><span class="pln"> getConfig</span><span class="pun">(</span><span class="str">'save_path'</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">global</span><span class="pln"> CONFIG_PATH
    </span><span class="com"># Highest priority configuration is via argument</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">config_path</span><span class="pun">:</span><span class="pln">
        CONFIG_PATH </span><span class="pun">=</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">config_path
        logging</span><span class="pun">.</span><span class="pln">debug</span><span class="pun">(</span><span class="str">"using alternative config path: %s"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> options</span><span class="pun">.</span><span class="pln">config_path</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">exists</span><span class="pun">(</span><span class="pln">options</span><span class="pun">.</span><span class="pln">config_path</span><span class="pun">):</span><span class="pln">
            error</span><span class="pun">(</span><span class="str">"the provided config path is not valid, exiting"</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="com"># Next, check to see if we're in the top level source directory (dev environment)</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">exists</span><span class="pun">(</span><span class="pln">default_configs</span><span class="pun">[</span><span class="str">'dev_config_path'</span><span class="pun">]):</span><span class="pln">
        CONFIG_PATH </span><span class="pun">=</span><span class="pln"> default_configs</span><span class="pun">[</span><span class="str">'dev_config_path'</span><span class="pun">]</span><span class="pln">
    </span><span class="com"># Next, check for an installed copy of the default configuration</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">exists</span><span class="pun">(</span><span class="pln">default_configs</span><span class="pun">[</span><span class="str">'sys_config_path'</span><span class="pun">]):</span><span class="pln">
        CONFIG_PATH </span><span class="pun">=</span><span class="pln"> default_configs</span><span class="pun">[</span><span class="str">'sys_config_path'</span><span class="pun">]</span><span class="pln">
    </span><span class="com"># Exit</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        error</span><span class="pun">(</span><span class="str">'A valid framework configuration was not found in either of the following locations:\
\n%s\n%s'</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">default_configs</span><span class="pun">[</span><span class="str">'dev_config_path'</span><span class="pun">],</span><span class="pln">default_configs</span><span class="pun">[</span><span class="str">'sys_config_path'</span><span class="pun">]))</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
       

    </span><span class="com"># Check for stdin in no arguments were provided</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">args</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">

        DATA_PATH </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">

        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">stdin</span><span class="pun">.</span><span class="pln">isatty</span><span class="pun">():</span><span class="pln">
            </span><span class="kwd">while</span><span class="pln"> </span><span class="kwd">True</span><span class="pun">:</span><span class="pln">
                f </span><span class="pun">=</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">stdin</span><span class="pun">.</span><span class="pln">readline</span><span class="pun">().</span><span class="pln">strip</span><span class="pun">()</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> f</span><span class="pun">:</span><span class="pln">
                    </span><span class="kwd">break</span><span class="pln">
                </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">isfile</span><span class="pun">(</span><span class="pln">f</span><span class="pun">):</span><span class="pln">
                        error</span><span class="pun">(</span><span class="str">"One of the specified files does not exist: %s"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">f</span><span class="pun">))</span><span class="pln">
                        </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">isdir</span><span class="pun">(</span><span class="pln">f</span><span class="pun">):</span><span class="pln">
                        error</span><span class="pun">(</span><span class="str">"One of the files you specified is actually a directory: %s"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">f</span><span class="pun">))</span><span class="pln">
                        </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
                    DATA_PATH</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">f</span><span class="pun">)</span><span class="pln">

        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> DATA_PATH</span><span class="pun">:</span><span class="pln">
            error</span><span class="pun">(</span><span class="str">"You must provide files via stdin when no arguments are provided"</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        logging</span><span class="pun">.</span><span class="pln">debug</span><span class="pun">(</span><span class="str">"Loaded %s files from stdin"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">DATA_PATH</span><span class="pun">)))</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">args</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">isdir</span><span class="pun">(</span><span class="pln">args</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]):</span><span class="pln">
            DATA_PATH </span><span class="pun">=</span><span class="pln"> args</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
        </span><span class="kwd">elif</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">isfile</span><span class="pun">(</span><span class="pln">args</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]):</span><span class="pln">
            DATA_PATH </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">args</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]]</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            error</span><span class="pun">(</span><span class="str">"File or directory does not exist: %s"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">args</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]))</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> f </span><span class="kwd">in</span><span class="pln"> args</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">isfile</span><span class="pun">(</span><span class="pln">f</span><span class="pun">):</span><span class="pln">
                error</span><span class="pun">(</span><span class="str">"One of the specified files does not exist: %s"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">f</span><span class="pun">))</span><span class="pln">
                </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">isdir</span><span class="pun">(</span><span class="pln">f</span><span class="pun">):</span><span class="pln">
                error</span><span class="pun">(</span><span class="str">"One of the files you specified is actually a directory: %s"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">f</span><span class="pun">))</span><span class="pln">
                </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        
        DATA_PATH </span><span class="pun">=</span><span class="pln"> args

   
    tasks </span><span class="pun">=</span><span class="pln"> multiprocessing</span><span class="pun">.</span><span class="typ">JoinableQueue</span><span class="pun">()</span><span class="pln">
    results </span><span class="pun">=</span><span class="pln"> multiprocessing</span><span class="pun">.</span><span class="typ">Queue</span><span class="pun">()</span><span class="pln">
    
    fileList </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> type</span><span class="pun">(</span><span class="pln">DATA_PATH</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">is</span><span class="pln"> str</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> root</span><span class="pun">,</span><span class="pln"> dirs</span><span class="pun">,</span><span class="pln"> files </span><span class="kwd">in</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">walk</span><span class="pun">(</span><span class="pln">DATA_PATH</span><span class="pun">):</span><span class="pln">
            files </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">f </span><span class="kwd">for</span><span class="pln"> f </span><span class="kwd">in</span><span class="pln"> files </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> f</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'.'</span><span class="pun">]</span><span class="pln">
            dirs</span><span class="pun">[:]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">d </span><span class="kwd">for</span><span class="pln"> d </span><span class="kwd">in</span><span class="pln"> dirs </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> d</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'.'</span><span class="pun">]</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> fname </span><span class="kwd">in</span><span class="pln"> files</span><span class="pun">:</span><span class="pln">
                fullpath </span><span class="pun">=</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">root</span><span class="pun">,</span><span class="pln"> fname</span><span class="pun">)</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">islink</span><span class="pun">(</span><span class="pln">fullpath</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">isfile</span><span class="pun">(</span><span class="pln">fullpath</span><span class="pun">):</span><span class="pln">
                    fileList</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">fullpath</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        fileList </span><span class="pun">=</span><span class="pln"> DATA_PATH

    </span><span class="kwd">if</span><span class="pln"> MAX_FILES</span><span class="pun">:</span><span class="pln">
        fileList </span><span class="pun">=</span><span class="pln"> fileList</span><span class="pun">[:</span><span class="pln">MAX_FILES</span><span class="pun">]</span><span class="pln">

    num_jobs </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">fileList</span><span class="pun">)</span><span class="pln">
    logging</span><span class="pun">.</span><span class="pln">debug</span><span class="pun">(</span><span class="str">"Loaded %s files for scanning"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">num_jobs</span><span class="pun">))</span><span class="pln">
    
    </span><span class="com"># Start consumers</span><span class="pln">
    </span><span class="com"># If there's less files to process than processes, reduce the number of processes</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> num_jobs </span><span class="pun">&lt;</span><span class="pln"> NUM_PROCS</span><span class="pun">:</span><span class="pln">
        NUM_PROCS </span><span class="pun">=</span><span class="pln"> num_jobs
    logging</span><span class="pun">.</span><span class="pln">debug</span><span class="pun">(</span><span class="str">"Starting %s processes"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">NUM_PROCS</span><span class="pun">))</span><span class="pln">
    consumers </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln"> </span><span class="typ">Consumer</span><span class="pun">(</span><span class="pln">tasks</span><span class="pun">,</span><span class="pln"> results</span><span class="pun">)</span><span class="pln">
                  </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">NUM_PROCS</span><span class="pun">)</span><span class="pln"> </span><span class="pun">]</span><span class="pln">
    </span><span class="kwd">try</span><span class="pun">:</span><span class="pln">
        
        </span><span class="kwd">for</span><span class="pln"> w </span><span class="kwd">in</span><span class="pln"> consumers</span><span class="pun">:</span><span class="pln">
            w</span><span class="pun">.</span><span class="pln">start</span><span class="pun">()</span><span class="pln">

        </span><span class="com"># Enqueue jobs</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> fname </span><span class="kwd">in</span><span class="pln"> fileList</span><span class="pun">:</span><span class="pln">
            tasks</span><span class="pun">.</span><span class="pln">put</span><span class="pun">(</span><span class="pln">fname</span><span class="pun">)</span><span class="pln">
        
        </span><span class="com"># Add a poison pill for each consumer</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">NUM_PROCS</span><span class="pun">):</span><span class="pln">
            tasks</span><span class="pun">.</span><span class="pln">put</span><span class="pun">(</span><span class="kwd">None</span><span class="pun">)</span><span class="pln">

        </span><span class="kwd">if</span><span class="pln"> PROGRESS_BAR</span><span class="pun">:</span><span class="pln">
            monitor </span><span class="pun">=</span><span class="pln"> </span><span class="typ">QueueMonitor</span><span class="pun">(</span><span class="pln">tasks</span><span class="pun">,</span><span class="pln"> num_jobs</span><span class="pun">)</span><span class="pln">
            monitor</span><span class="pun">.</span><span class="pln">start</span><span class="pun">()</span><span class="pln">

        </span><span class="com"># Wait for all of the tasks to finish</span><span class="pln">
        tasks</span><span class="pun">.</span><span class="pln">join</span><span class="pun">()</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> PROGRESS_BAR</span><span class="pun">:</span><span class="pln">
            monitor</span><span class="pun">.</span><span class="pln">join</span><span class="pun">()</span><span class="pln">

        </span><span class="kwd">while</span><span class="pln"> num_jobs</span><span class="pun">:</span><span class="pln">
            answer </span><span class="pun">=</span><span class="pln"> zlib</span><span class="pun">.</span><span class="pln">decompress</span><span class="pun">(</span><span class="pln">results</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">())</span><span class="pln">
            </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">answer</span><span class="pun">)</span><span class="pln">
            num_jobs </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">

    </span><span class="kwd">except</span><span class="pln"> </span><span class="typ">KeyboardInterrupt</span><span class="pun">:</span><span class="pln">
        error</span><span class="pun">(</span><span class="str">"Cancelled by user.. Shutting down."</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> w </span><span class="kwd">in</span><span class="pln"> consumers</span><span class="pun">:</span><span class="pln">
            w</span><span class="pun">.</span><span class="pln">terminate</span><span class="pun">()</span><span class="pln">
            w</span><span class="pun">.</span><span class="pln">join</span><span class="pun">()</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">None</span><span class="pln">
    </span><span class="kwd">except</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">raise</span><span class="pln">

 </span></pre><br>
		</div>
		
	</div>
	
		
	
		<div style="width:100%; margin-top:20px;">
	
		<p style="color:#424345; font-weight:bold; width:50%;">Example 45</p>
	
		<div style="margin-top:10px;">
		
		
			

			
			
			
		

			


			
			<p>
				From project <span style="font-style:italic;">hostap-ct</span>, 
				under directory <span style="font-style:italic;">tests/hwsim/vm</span>, 
				in source file <span style="font-style:italic;">parallel-vm.py</span>.
			</p>
		</div>
			
		<div class="code">		
		
			<div style="float: right;cursor:hand; margin: 8px 10px 0 0 ;">
			
				<table>
				<tbody><tr>
				<td>
				<div style="color:grey; font-size:14px;">
				Score: 5				</div>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_up" id="138488">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_up.png" width="26">
				</span>
				</td>
				</tr>
				
				<tr>
				<td align="right">
				<span class="vote_down" id="138488">
					<img alt="vote" src="./Python logging.FileHandler Examples_files/vote_down.png" width="26">
				</span>
				</td>
				</tr>
				</tbody></table>	
			</div>			
			
			
			<pre class="prettyprint"><span class="kwd">def</span><span class="pln"> main</span><span class="pun">():</span><span class="pln">
    </span><span class="kwd">import</span><span class="pln"> argparse
    </span><span class="kwd">import</span><span class="pln"> os
    </span><span class="kwd">global</span><span class="pln"> num_servers
    </span><span class="kwd">global</span><span class="pln"> vm
    </span><span class="kwd">global</span><span class="pln"> dir
    </span><span class="kwd">global</span><span class="pln"> timestamp
    </span><span class="kwd">global</span><span class="pln"> tests
    </span><span class="kwd">global</span><span class="pln"> first_run_failures
    </span><span class="kwd">global</span><span class="pln"> total_started</span><span class="pun">,</span><span class="pln"> total_passed</span><span class="pun">,</span><span class="pln"> total_failed</span><span class="pun">,</span><span class="pln"> total_skipped
    </span><span class="kwd">global</span><span class="pln"> rerun_failures

    total_started </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    total_passed </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    total_failed </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    total_skipped </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">

    debug_level </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">INFO
    rerun_failures </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln">
    timestamp </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">time</span><span class="pun">.</span><span class="pln">time</span><span class="pun">())</span><span class="pln">

    scriptsdir </span><span class="pun">=</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">dirname</span><span class="pun">(</span><span class="pln">os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">realpath</span><span class="pun">(</span><span class="pln">sys</span><span class="pun">.</span><span class="pln">argv</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]))</span><span class="pln">

    p </span><span class="pun">=</span><span class="pln"> argparse</span><span class="pun">.</span><span class="typ">ArgumentParser</span><span class="pun">(</span><span class="pln">description</span><span class="pun">=</span><span class="str">'run multiple testing VMs in parallel'</span><span class="pun">)</span><span class="pln">
    p</span><span class="pun">.</span><span class="pln">add_argument</span><span class="pun">(</span><span class="str">'num_servers'</span><span class="pun">,</span><span class="pln"> metavar</span><span class="pun">=</span><span class="str">'number of VMs'</span><span class="pun">,</span><span class="pln"> type</span><span class="pun">=</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> choices</span><span class="pun">=</span><span class="pln">range</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">100</span><span class="pun">),</span><span class="pln">
                   help</span><span class="pun">=</span><span class="str">"number of VMs to start"</span><span class="pun">)</span><span class="pln">
    p</span><span class="pun">.</span><span class="pln">add_argument</span><span class="pun">(</span><span class="str">'-f'</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">'testmodules'</span><span class="pun">,</span><span class="pln"> metavar</span><span class="pun">=</span><span class="str">'&lt;test module&gt;'</span><span class="pun">,</span><span class="pln">
                   help</span><span class="pun">=</span><span class="str">'execute only tests from these test modules'</span><span class="pun">,</span><span class="pln">
                   type</span><span class="pun">=</span><span class="pln">str</span><span class="pun">,</span><span class="pln"> nargs</span><span class="pun">=</span><span class="str">'+'</span><span class="pun">)</span><span class="pln">
    p</span><span class="pun">.</span><span class="pln">add_argument</span><span class="pun">(</span><span class="str">'-1'</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">'no_retry'</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">'store_const'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln">
                   help</span><span class="pun">=</span><span class="str">"don't retry failed tests automatically"</span><span class="pun">)</span><span class="pln">
    p</span><span class="pun">.</span><span class="pln">add_argument</span><span class="pun">(</span><span class="str">'--debug'</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">'debug'</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">'store_const'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln">
                   help</span><span class="pun">=</span><span class="str">"enable debug logging"</span><span class="pun">)</span><span class="pln">
    p</span><span class="pun">.</span><span class="pln">add_argument</span><span class="pun">(</span><span class="str">'--codecov'</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">'codecov'</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">'store_const'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln">
                   help</span><span class="pun">=</span><span class="str">"enable code coverage collection"</span><span class="pun">)</span><span class="pln">
    p</span><span class="pun">.</span><span class="pln">add_argument</span><span class="pun">(</span><span class="str">'--shuffle-tests'</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">'shuffle'</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">'store_const'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln">
                   help</span><span class="pun">=</span><span class="str">"shuffle test cases to randomize order"</span><span class="pun">)</span><span class="pln">
    p</span><span class="pun">.</span><span class="pln">add_argument</span><span class="pun">(</span><span class="str">'--short'</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">'short'</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">'store_const'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">,</span><span class="pln">
                   </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln">
                   help</span><span class="pun">=</span><span class="str">"only run short-duration test cases"</span><span class="pun">)</span><span class="pln">
    p</span><span class="pun">.</span><span class="pln">add_argument</span><span class="pun">(</span><span class="str">'--long'</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">'long'</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">'store_const'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">,</span><span class="pln">
                   </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln">
                   help</span><span class="pun">=</span><span class="str">"include long-duration test cases"</span><span class="pun">)</span><span class="pln">
    p</span><span class="pun">.</span><span class="pln">add_argument</span><span class="pun">(</span><span class="str">'--valgrind'</span><span class="pun">,</span><span class="pln"> dest</span><span class="pun">=</span><span class="str">'valgrind'</span><span class="pun">,</span><span class="pln"> action</span><span class="pun">=</span><span class="str">'store_const'</span><span class="pun">,</span><span class="pln">
                   </span><span class="kwd">const</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">default</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln">
                   help</span><span class="pun">=</span><span class="str">"run tests under valgrind"</span><span class="pun">)</span><span class="pln">
    p</span><span class="pun">.</span><span class="pln">add_argument</span><span class="pun">(</span><span class="str">'params'</span><span class="pun">,</span><span class="pln"> nargs</span><span class="pun">=</span><span class="str">'*'</span><span class="pun">)</span><span class="pln">
    args </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">parse_args</span><span class="pun">()</span><span class="pln">
    num_servers </span><span class="pun">=</span><span class="pln"> args</span><span class="pun">.</span><span class="pln">num_servers
    rerun_failures </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> args</span><span class="pun">.</span><span class="pln">no_retry
    </span><span class="kwd">if</span><span class="pln"> args</span><span class="pun">.</span><span class="pln">debug</span><span class="pun">:</span><span class="pln">
        debug_level </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="pln">DEBUG
    extra_args </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> args</span><span class="pun">.</span><span class="pln">valgrind</span><span class="pun">:</span><span class="pln">
        extra_args </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">[</span><span class="pln"> </span><span class="str">'--valgrind'</span><span class="pln"> </span><span class="pun">]</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> args</span><span class="pun">.</span><span class="kwd">long</span><span class="pun">:</span><span class="pln">
        extra_args </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">[</span><span class="pln"> </span><span class="str">'--long'</span><span class="pln"> </span><span class="pun">]</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> args</span><span class="pun">.</span><span class="pln">codecov</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"Code coverage - build separate binaries"</span><span class="pln">
        logdir </span><span class="pun">=</span><span class="pln"> </span><span class="str">"/tmp/hwsim-test-logs/"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> str</span><span class="pun">(</span><span class="pln">timestamp</span><span class="pun">)</span><span class="pln">
        os</span><span class="pun">.</span><span class="pln">makedirs</span><span class="pun">(</span><span class="pln">logdir</span><span class="pun">)</span><span class="pln">
        subprocess</span><span class="pun">.</span><span class="pln">check_call</span><span class="pun">([</span><span class="pln">os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">scriptsdir</span><span class="pun">,</span><span class="pln"> </span><span class="str">'build-codecov.sh'</span><span class="pun">),</span><span class="pln">
                               logdir</span><span class="pun">])</span><span class="pln">
        codecov_args </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="str">'--codecov_dir'</span><span class="pun">,</span><span class="pln"> logdir</span><span class="pun">]</span><span class="pln">
        codecov </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        codecov_args </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
        codecov </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">

    first_run_failures </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> args</span><span class="pun">.</span><span class="kwd">params</span><span class="pun">:</span><span class="pln">
        tests </span><span class="pun">=</span><span class="pln"> args</span><span class="pun">.</span><span class="kwd">params</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        tests </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
        cmd </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">dirname</span><span class="pun">(</span><span class="pln">scriptsdir</span><span class="pun">),</span><span class="pln"> </span><span class="str">'run-tests.py'</span><span class="pun">),</span><span class="pln">
                </span><span class="str">'-L'</span><span class="pln"> </span><span class="pun">]</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> args</span><span class="pun">.</span><span class="pln">testmodules</span><span class="pun">:</span><span class="pln">
            cmd </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">[</span><span class="pln"> </span><span class="str">"-f"</span><span class="pln"> </span><span class="pun">]</span><span class="pln">
            cmd </span><span class="pun">+=</span><span class="pln"> args</span><span class="pun">.</span><span class="pln">testmodules
        lst </span><span class="pun">=</span><span class="pln"> subprocess</span><span class="pun">.</span><span class="typ">Popen</span><span class="pun">(</span><span class="pln">cmd</span><span class="pun">,</span><span class="pln"> stdout</span><span class="pun">=</span><span class="pln">subprocess</span><span class="pun">.</span><span class="pln">PIPE</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> l </span><span class="kwd">in</span><span class="pln"> lst</span><span class="pun">.</span><span class="pln">stdout</span><span class="pun">.</span><span class="pln">readlines</span><span class="pun">():</span><span class="pln">
            name </span><span class="pun">=</span><span class="pln"> l</span><span class="pun">.</span><span class="pln">split</span><span class="pun">(</span><span class="str">' '</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
            tests</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">name</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">tests</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
        sys</span><span class="pun">.</span><span class="kwd">exit</span><span class="pun">(</span><span class="str">"No test cases selected"</span><span class="pun">)</span><span class="pln">

    dir </span><span class="pun">=</span><span class="pln"> </span><span class="str">'/tmp/hwsim-test-logs'</span><span class="pln">
    </span><span class="kwd">try</span><span class="pun">:</span><span class="pln">
        os</span><span class="pun">.</span><span class="pln">mkdir</span><span class="pun">(</span><span class="pln">dir</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">except</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">pass</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> args</span><span class="pun">.</span><span class="pln">shuffle</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">from</span><span class="pln"> random </span><span class="kwd">import</span><span class="pln"> shuffle
        shuffle</span><span class="pun">(</span><span class="pln">tests</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> num_servers </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">tests</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">100</span><span class="pun">:</span><span class="pln">
        </span><span class="com"># Move test cases with long duration to the beginning as an</span><span class="pln">
        </span><span class="com"># optimization to avoid last part of the test execution running a long</span><span class="pln">
        </span><span class="com"># duration test case on a single VM while all other VMs have already</span><span class="pln">
        </span><span class="com"># completed their work.</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> l </span><span class="kwd">in</span><span class="pln"> long_tests</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> l </span><span class="kwd">in</span><span class="pln"> tests</span><span class="pun">:</span><span class="pln">
                tests</span><span class="pun">.</span><span class="pln">remove</span><span class="pun">(</span><span class="pln">l</span><span class="pun">)</span><span class="pln">
                tests</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> args</span><span class="pun">.</span><span class="kwd">short</span><span class="pun">:</span><span class="pln">
        tests </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">t </span><span class="kwd">for</span><span class="pln"> t </span><span class="kwd">in</span><span class="pln"> tests </span><span class="kwd">if</span><span class="pln"> t </span><span class="kwd">not</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> long_tests</span><span class="pun">]</span><span class="pln">

    logger</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">debug_level</span><span class="pun">)</span><span class="pln">
    log_handler </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="highlight"><span class="typ">FileHandler</span></span><span class="pun">(</span><span class="str">'parallel-vm.log'</span><span class="pun">)</span><span class="pln">
    log_handler</span><span class="pun">.</span><span class="pln">setLevel</span><span class="pun">(</span><span class="pln">debug_level</span><span class="pun">)</span><span class="pln">
    fmt </span><span class="pun">=</span><span class="pln"> </span><span class="str">"%(asctime)s %(levelname)s %(message)s"</span><span class="pln">
    log_formatter </span><span class="pun">=</span><span class="pln"> logging</span><span class="pun">.</span><span class="typ">Formatter</span><span class="pun">(</span><span class="pln">fmt</span><span class="pun">)</span><span class="pln">
    log_handler</span><span class="pun">.</span><span class="pln">setFormatter</span><span class="pun">(</span><span class="pln">log_formatter</span><span class="pun">)</span><span class="pln">
    logger</span><span class="pun">.</span><span class="pln">addHandler</span><span class="pun">(</span><span class="pln">log_handler</span><span class="pun">)</span><span class="pln">

    vm </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> num_servers</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"\rStarting virtual machine {}/{}"</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> num_servers</span><span class="pun">)),</span><span class="pln">
        logger</span><span class="pun">.</span><span class="pln">info</span><span class="pun">(</span><span class="str">"Starting virtual machine {}/{}"</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> num_servers</span><span class="pun">))</span><span class="pln">
        cmd </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">scriptsdir</span><span class="pun">,</span><span class="pln"> </span><span class="str">'vm-run.sh'</span><span class="pun">),</span><span class="pln"> </span><span class="str">'--delay'</span><span class="pun">,</span><span class="pln"> str</span><span class="pun">(</span><span class="pln">i</span><span class="pun">),</span><span class="pln">
               </span><span class="str">'--timestamp'</span><span class="pun">,</span><span class="pln"> str</span><span class="pun">(</span><span class="pln">timestamp</span><span class="pun">),</span><span class="pln">
               </span><span class="str">'--ext'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'srv.%d'</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln">
               </span><span class="str">'-i'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> codecov_args </span><span class="pun">+</span><span class="pln"> extra_args
        vm</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
        vm</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="str">'first_run_done'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
        vm</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="str">'proc'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> subprocess</span><span class="pun">.</span><span class="typ">Popen</span><span class="pun">(</span><span class="pln">cmd</span><span class="pun">,</span><span class="pln">
                                         stdin</span><span class="pun">=</span><span class="pln">subprocess</span><span class="pun">.</span><span class="pln">PIPE</span><span class="pun">,</span><span class="pln">
                                         stdout</span><span class="pun">=</span><span class="pln">subprocess</span><span class="pun">.</span><span class="pln">PIPE</span><span class="pun">,</span><span class="pln">
                                         stderr</span><span class="pun">=</span><span class="pln">subprocess</span><span class="pun">.</span><span class="pln">PIPE</span><span class="pun">)</span><span class="pln">
        vm</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="str">'out'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pln">
        vm</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="str">'pending'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pln">
        vm</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="str">'err'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pln">
        vm</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="str">'failed'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> stream </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">[</span><span class="pln"> vm</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="str">'proc'</span><span class="pun">].</span><span class="pln">stdout</span><span class="pun">,</span><span class="pln"> vm</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="str">'proc'</span><span class="pun">].</span><span class="pln">stderr </span><span class="pun">]:</span><span class="pln">
            fd </span><span class="pun">=</span><span class="pln"> stream</span><span class="pun">.</span><span class="pln">fileno</span><span class="pun">()</span><span class="pln">
            fl </span><span class="pun">=</span><span class="pln"> fcntl</span><span class="pun">.</span><span class="pln">fcntl</span><span class="pun">(</span><span class="pln">fd</span><span class="pun">,</span><span class="pln"> fcntl</span><span class="pun">.</span><span class="pln">F_GETFL</span><span class="pun">)</span><span class="pln">
            fcntl</span><span class="pun">.</span><span class="pln">fcntl</span><span class="pun">(</span><span class="pln">fd</span><span class="pun">,</span><span class="pln"> fcntl</span><span class="pun">.</span><span class="pln">F_SETFL</span><span class="pun">,</span><span class="pln"> fl </span><span class="pun">|</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">O_NONBLOCK</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">print</span><span class="pln">

    curses</span><span class="pun">.</span><span class="pln">wrapper</span><span class="pun">(</span><span class="pln">show_progress</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">with</span><span class="pln"> open</span><span class="pun">(</span><span class="str">'{}/{}-parallel.log'</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">dir</span><span class="pun">,</span><span class="pln"> timestamp</span><span class="pun">),</span><span class="pln"> </span><span class="str">'w'</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> f</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> num_servers</span><span class="pun">):</span><span class="pln">
            f</span><span class="pun">.</span><span class="pln">write</span><span class="pun">(</span><span class="str">'VM {}\n{}\n{}\n'</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> vm</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="str">'out'</span><span class="pun">],</span><span class="pln"> vm</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="str">'err'</span><span class="pun">]))</span><span class="pln">

    failed </span><span class="pun">=</span><span class="pln"> get_failed</span><span class="pun">(</span><span class="pln">vm</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> first_run_failures</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"Failed test cases:"</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> f </span><span class="kwd">in</span><span class="pln"> first_run_failures</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">print</span><span class="pln"> f</span><span class="pun">,</span><span class="pln">
            logger</span><span class="pun">.</span><span class="pln">info</span><span class="pun">(</span><span class="str">"Failed: "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> f</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">print</span><span class="pln">
    double_failed </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> name </span><span class="kwd">in</span><span class="pln"> failed</span><span class="pun">:</span><span class="pln">
        double_failed</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">name</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> test </span><span class="kwd">in</span><span class="pln"> first_run_failures</span><span class="pun">:</span><span class="pln">
        double_failed</span><span class="pun">.</span><span class="pln">remove</span><span class="pun">(</span><span class="pln">test</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> rerun_failures</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">pass</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> failed </span><span class="kwd">and</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> double_failed</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"All failed cases passed on retry"</span><span class="pln">
        logger</span><span class="pun">.</span><span class="pln">info</span><span class="pun">(</span><span class="str">"All failed cases passed on retry"</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pln"> double_failed</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"Failed even on retry:"</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> f </span><span class="kwd">in</span><span class="pln"> double_failed</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">print</span><span class="pln"> f</span><span class="pun">,</span><span class="pln">
            logger</span><span class="pun">.</span><span class="pln">info</span><span class="pun">(</span><span class="str">"Failed on retry: "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> f</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">print</span><span class="pln">
    res </span><span class="pun">=</span><span class="pln"> </span><span class="str">"TOTAL={} PASS={} FAIL={} SKIP={}"</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">total_started</span><span class="pun">,</span><span class="pln">
                                                    total_passed</span><span class="pun">,</span><span class="pln">
                                                    total_failed</span><span class="pun">,</span><span class="pln">
                                                    total_skipped</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">res</span><span class="pun">)</span><span class="pln">
    logger</span><span class="pun">.</span><span class="pln">info</span><span class="pun">(</span><span class="pln">res</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"Logs: "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dir </span><span class="pun">+</span><span class="pln"> </span><span class="str">'/'</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> str</span><span class="pun">(</span><span class="pln">timestamp</span><span class="pun">)</span><span class="pln">
    logger</span><span class="pun">.</span><span class="pln">info</span><span class="pun">(</span><span class="str">"Logs: "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dir </span><span class="pun">+</span><span class="pln"> </span><span class="str">'/'</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> str</span><span class="pun">(</span><span class="pln">timestamp</span><span class="pun">))</span><span class="pln">

    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> num_servers</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">vm</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="str">'pending'</span><span class="pun">])</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
            logger</span><span class="pun">.</span><span class="pln">info</span><span class="pun">(</span><span class="str">"Unprocessed stdout from VM[%d]: '%s'"</span><span class="pln"> </span><span class="pun">%</span><span class="pln">
                        </span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> vm</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="str">'pending'</span><span class="pun">]))</span><span class="pln">
        log </span><span class="pun">=</span><span class="pln"> </span><span class="str">'{}/{}.srv.{}/console'</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">dir</span><span class="pun">,</span><span class="pln"> timestamp</span><span class="pun">,</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">with</span><span class="pln"> open</span><span class="pun">(</span><span class="pln">log</span><span class="pun">,</span><span class="pln"> </span><span class="str">'r'</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> f</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="str">"Kernel panic"</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> f</span><span class="pun">.</span><span class="pln">read</span><span class="pun">():</span><span class="pln">
                </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"Kernel panic in "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> log
                logger</span><span class="pun">.</span><span class="pln">info</span><span class="pun">(</span><span class="str">"Kernel panic in "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> log</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> codecov</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"Code coverage - preparing report"</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">num_servers</span><span class="pun">):</span><span class="pln">
            subprocess</span><span class="pun">.</span><span class="pln">check_call</span><span class="pun">([</span><span class="pln">os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">scriptsdir</span><span class="pun">,</span><span class="pln">
                                                </span><span class="str">'process-codecov.sh'</span><span class="pun">),</span><span class="pln">
                                   logdir </span><span class="pun">+</span><span class="pln"> </span><span class="str">".srv.%d"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln">
                                   str</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)])</span><span class="pln">
        subprocess</span><span class="pun">.</span><span class="pln">check_call</span><span class="pun">([</span><span class="pln">os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">scriptsdir</span><span class="pun">,</span><span class="pln"> </span><span class="str">'combine-codecov.sh'</span><span class="pun">),</span><span class="pln">
                               logdir</span><span class="pun">])</span><span class="pln">
        </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"file://%s/index.html"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> logdir
        logger</span><span class="pun">.</span><span class="pln">info</span><span class="pun">(</span><span class="str">"Code coverage report: file://%s/index.html"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> logdir</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> double_failed </span><span class="kwd">or</span><span class="pln"> </span><span class="pun">(</span><span class="pln">failed </span><span class="kwd">and</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> rerun_failures</span><span class="pun">):</span><span class="pln">
        logger</span><span class="pun">.</span><span class="pln">info</span><span class="pun">(</span><span class="str">"Test run complete - failures found"</span><span class="pun">)</span><span class="pln">
        sys</span><span class="pun">.</span><span class="kwd">exit</span><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> failed</span><span class="pun">:</span><span class="pln">
        logger</span><span class="pun">.</span><span class="pln">info</span><span class="pun">(</span><span class="str">"Test run complete - failures found on first run; passed on retry"</span><span class="pun">)</span><span class="pln">
        sys</span><span class="pun">.</span><span class="kwd">exit</span><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    logger</span><span class="pun">.</span><span class="pln">info</span><span class="pun">(</span><span class="str">"Test run complete - no failures"</span><span class="pun">)</span><span class="pln">
    sys</span><span class="pun">.</span><span class="kwd">exit</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span><span class="pln">

 </span></pre><br>
		</div>
		
	</div>
	
		
	
	<script type="text/javascript">
$('.vote').hover(
		function () {
			$(this).addClass("hover");
		},
		function () {
			$(this).removeClass("hover");
		}
	);
	
	$('pre').highlight("FileHandler", { 
		caseSensitive: true, 
		wordsOnly:true,
		wordsBoundary: '[\\b\\W]' 
		});
</script>




</div><!-- content 2, i.e. left -->



<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'programcreek';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the &lt;a href="https://disqus.com/?ref_noscript" rel="nofollow"&gt;comments powered by Disqus.&lt;/a&gt;</noscript>


</div>


<!--end of main content-->


 

	<!-- footer -->
	
<!--
	<div id="footer">		
		<p style="text-align:center;">
					All code examples are from open source projects from GitHub<br>
		</p>
	</div>
-->
	

    


	
	
	
</body></html>